<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Administration guide for Red Hat Developer Hub</title>
<style>
/* Red Hat Fonts */
@font-face {
  font-family: 'Red Hat Display';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatDisplay/RedHatDisplayVF.woff2") format('woff2-variations');
  font-weight: 300 900;
  font-style: normal;
  font-display: fallback;
}
@font-face {
  font-family: 'Red Hat Display';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatDisplay/RedHatDisplayVF-Italic.woff2") format('woff2-variations');
  font-weight: 300 900;
  font-style: italic;
  font-display: fallback;
}
@font-face {
  font-family: 'Red Hat Text';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatText/RedHatTextVF.woff2") format('woff2-variations');
  font-weight: 300 700;
  font-style: normal;
  font-display: fallback;
}
@font-face {
  font-family: 'Red Hat Text';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatText/RedHatTextVF-Italic.woff2") format('woff2-variations');
  font-weight: 300 700;
  font-style: italic;
  font-display: fallback;
}
@font-face {
  font-family: 'Red Hat Mono';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatMono/RedHatMonoVF.woff2") format('woff2-variations');
  font-weight: 300 700;
  font-style: normal;
  font-display: fallback;
}
@font-face {
  font-family: 'Red Hat Mono';
  src: url("https://redhatofficial.github.io/RedHatFont/RedHatMono/RedHatMonoVF-Italic.woff2") format('woff2-variations');
  font-weight: 300 700;
  font-style: italic;
  font-display: fallback;
}

/* Positioning toc and content */
@media screen and (min-width: 768px) {
  body.toc2 {
    padding-left: 400px;
    padding-right: 0;
  }
}
@media screen and (min-width: 768px) {
  #toc.toc2 {
    margin-top: 0 !important;
    position: fixed;
    width: 319px;
    left: 0;
    top: 0;
    border-right: 1px solid #e7e7e9;
    border-top-width: 0 !important;
    border-bottom-width: 0 !important;
    z-index: 1000;
    padding: 1.25em 1em;
    height: 100%;
    overflow: auto;
  }
}

/* Style borrowed from docs.redhat.com and adapted to the HTML structure */

#toc.toc2 {
  background:#f2f2f2;
  justify-content:space-between;
  margin:1rem 0 2rem;
  padding:1rem
}
#toctitle {
  font-size:1.25rem;
  font-weight:400;
  line-height:1.6667;
  margin-top:0;
  text-transform:none
}
#toc li {
  margin-bottom:.25em;
  padding-left:0;
  list-style:none;
}
#toc a,
#toc a:visited {
  color:black;
  display:inline-block;
  text-decoration:none;
}

.sectlevel1 {
  padding-left:0;
}

.sectlevel2,
.sectlevel3,
.sectlevel4,
.sectlevel5 {
  padding-left:1em;
}

h3 {
  color:#464646;
  font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);
  font-size:var(--rh-font-size-body-text-lg,1.125rem)
}

li {
  display:list-item;
  margin:0;
  padding:0;
  text-align:-webkit-match-parent
}

*,
:after,
:before,
:after,
:before {
  box-sizing:border-box
}
img,
object,
svg,
img,
object,
svg {
  display:inline-block;
  max-width:100%;
  vertical-align:middle
}
hr {
  border:0;
  border-top:.0625rem solid #d2d2d2;
  clear:both;
  margin:1rem 0
}
a {
  color:#06c;
  text-decoration:underline
}
a:focus,
a:hover {
  color:#036
}
p {
  margin:1.49963rem 0
}
li>p {
  margin:0
}
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;
  font-weight:400;
  margin:0 0 .625rem;
  color:#464646;
}
h1 {
  font-size:2rem;
  margin:2rem 0
}
h2 {
  font-size:2rem;
  margin:2rem 0
}
h3 {
  font-size:1.65rem;
  font-weight:400
}
h4 {
  font-size:1.5rem
}
h5 {
  font-size:1.25rem
  font-weight:400
}
h6 {
  font-size:1.125rem;
  font-weight:500;
  line-height:1.6667
}
ol ::marker,
ul ::marker {
  font:inherit
}
li {
  margin:0 0 .5em;
  padding:0
}
li>p {
  margin:.5rem 0
}
li>ol,
li>ul {
  margin:0
}
dl dd {
  margin:.5rem 0 .5rem 1rem
}
dl dd>p {
  margin:.5rem 0
}
.informaltable,
.table-contents,
.table-wrapper {
  max-height:var(--rh-table--maxHeight);
  overflow:auto
}
table {
  border:0;
  font-size:1rem;
  line-height:1.6667;
  table-layout:fixed
}
table caption {
  color:#585858;
  margin-bottom:.5rem;
  margin-top:.5rem;
  text-align:left
}
table td,
table th {
  border:0;
  border-bottom:.0625rem solid #d2d2d2;
  border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);
  padding:.5em 1rem
}
table td.halign-left,
table th.halign-left {
  text-align:left
}
table td.halign-center,
table th.halign-center,
table td.halign-center,
table th.halign-center {
  text-align:center
}
table td.halign-right,
table th.halign-right {
  text-align:right
}
table td.valign-top,
table th.valign-top {
  vertical-align:top
}
table td.valign-middle,
table th.valign-middle {
  vertical-align:middle
}
table td.valign-bottom,
table th.valign-bottom {
  vertical-align:bottom
}
table thead td,
table thead th {
  background:#f5f5f5;
  font-weight:600
}
rh-table table,
rh-table.rh-table--expanded-vertically {
  max-height:-moz-max-content;
  max-height:max-content
}
pre.nowrap {
  overflow:auto;
  overflow-wrap:normal;
  white-space:pre;
  word-break:normal
}
.listingblock pre {
  background:transparent
}

[class] pre code {
  background:inherit;
  color:inherit;
  font-family:inherit;
  font-size:inherit;
  font-weight:inherit;
  line-height:inherit;
  padding:0
}
.keycap,
kbd {
  background-color:#eee;
  background-image:linear-gradient(180deg,#ddd,#eee,#fff);
  border-radius:.1875rem;
  box-shadow:0 -.0625rem #fff,0 .0625rem 0 .1875rem #aaa;
  font-family:RedHatMono,Red Hat Mono,Consolas,monospace;
  font-size:90%;
  font-weight:400;
  margin:0 .25rem;
  padding:.125rem .375rem
}
.keycap strong,
.keycap strong {
  font-weight:inherit
}
kbd.keyseq,
kbd.keyseq {
  background:transparent;
  border:0;
  box-shadow:none;
  padding:0
}
kbd.keyseq kbd,
kbd.keyseq kbd {
  display:inline-block;
  margin:0 .375rem
}
kbd.keyseq kbd:first-child,
kbd.keyseq kbd:first-child {
  margin-left:0
}
b.button {
  font-size:90%;
  font-weight:700;
  padding:.1875rem
}
b.button:before {
  content:"["
}
b.button:after {
  content:"]"
}
html {
  font-family:sans-serif;
  -ms-text-size-adjust:100%;
  -webkit-text-size-adjust:100%
}
body {
  margin:0
}
audio,
canvas,
progress,
video {
  display:inline-block;
  vertical-align:baseline
}
audio:not([controls]) {
  display:none;
  height:0
}
[hidden],
template {
  display:none
}
a {
  background:transparent
}
a:active,
a:hover {
  outline:0
}
abbr[title] {
  border-bottom:.0625rem dotted
}
dfn {
  font-style:italic
}

mark {
  background:#ff0;
  color:#000
}
small {
  font-size:80%
}
sub,
sup {
  font-size:75%;
  line-height:0;
  position:relative;
  vertical-align:baseline
}
sup {
  top:-.5em
}
sub {
  bottom:-.25em
}
img {
  border:0
}
svg:not(:root) {
  overflow:hidden
}
figure {
  margin:1em 2.5rem
}
hr {
  box-sizing:content-box;
  height:0
}
code,
kbd,
pre,
samp {
  font-family:monospace,monospace;
  font-size:1em
}
button,
optgroup,
select,
textarea,
.rhdocsinput {
  color:inherit;
  font:inherit;
  margin:0
}
button {
  overflow:visible
}
button,
select {
  text-transform:none
}
button,
html input[type=button],
input[type=reset],
input[type=submit] {
  -moz-appearance:button;
  appearance:button;
  -webkit-appearance:button;
  cursor:pointer
}
button[disabled],
html input[disabled] {
  cursor:default
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border:0;
  padding:0
}
input {
  line-height:normal
}
input[type=checkbox],
input[type=radio] {
  box-sizing:border-box;
  padding:0
}
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
  height:auto
}
input[type=search] {
  -moz-appearance:textfield;
  appearance:textfield;
  -webkit-appearance:textfield;
  box-sizing:content-box
}
input[type=search]::-webkit-search-cancel-button,
input[type=search]::-webkit-search-decoration {
  -webkit-appearance:none
}
fieldset {
  border:.0625rem solid silver;
  margin:0 .125rem;
  padding:.35em .625em .75em
}
legend {
  border:0;
  padding:0
}
textarea {
  overflow:auto
}
optgroup {
  font-weight:700
}
table {
  border-collapse:collapse;
  border-spacing:0
}
td,
th {
  padding:0
}

.admonitionblock>div:nth-child(2),
.caution>div:nth-child(2),
.important>div:nth-child(2),
.note>div:nth-child(2),
.tip>div:nth-child(2),
.warning>div:nth-child(2) {
  margin:.5rem 0
}
.admonitionblock>div:nth-child(2)>:first-child,
.caution>div:nth-child(2)>:first-child,
.important>div:nth-child(2)>:first-child,
.note>div:nth-child(2)>:first-child,
.tip>div:nth-child(2)>:first-child,
.warning>div:nth-child(2)>:first-child {
  margin-top:0
}
.admonitionblock>div:nth-child(2)>:last-child,
.caution>div:nth-child(2)>:last-child,
.important>div:nth-child(2)>:last-child,
.note>div:nth-child(2)>:last-child,
.tip>div:nth-child(2)>:last-child,
.warning>div:nth-child(2)>:last-child {
  margin-bottom:0
}
.listingblock+.listingblock,
pre+pre,
pre[class]+pre[class] {
  margin-top:2rem
}
.listingblock {
  background:#f8f8f8;
  overflow:visible;
  position:relative;
  transform:translate(0);
  z-index:0;
  border: 1px solid grey;
  border-radius:.1rem;
}
.listingblock:before {
  background-repeat:no-repeat;
  background-size:6.25rem 100%;
  bottom:var(--scrollbar__height,1px);
  content:"";
  display:block;
  height:7.125rem;
  max-height:100%;
  max-height:calc(100% - var(--scrollbar__height, 2px));
  position:absolute;
  right:var(--scrollbar__width,6px);
  top:.0625rem;
  width:4.0625rem;
  z-index:1
}

.colist>ol {
  counter-reset:colist;
  list-style:none;
  margin:1rem 0 2rem;
  padding:0
}
.colist>ol>li {
  counter-increment:colist;
  margin:.5rem 0;
  padding-left:1.75rem;
  position:relative;
}
.colist>ol>li:before {
  content:counter(colist);
  left:0;
  position:absolute;
  top:.1875rem
}
.colist>ol>li:before,
.conum {
  background:#06c;
  border-radius:50%;
  color:#fff;
  display:inline-block;
  font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;
  font-style:normal;
  font-weight:600;
  height:1.25rem;
  line-height:1.35rem;
  padding:0;
  text-align:center;
  top:-.125em;
  vertical-align:middle;
  width:1.25rem
}
.colist div.paragraph {
  margin:0
}

rh-table {
  display:block
}
::-webkit-scrollbar,
:host ::-webkit-scrollbar {
  height:.625rem;
  width:.625rem
}
::-webkit-scrollbar,
::-webkit-scrollbar-track,
:host ::-webkit-scrollbar,
:host ::-webkit-scrollbar-track {
  background-color:#d6d6d6
}
::-webkit-scrollbar-thumb,
:host ::-webkit-scrollbar-thumb {
  background-color:#8e8e8e
}
*,
:host * {
  scrollbar-color:#8e8e8e #d6d6d6
}
p:empty,
p:empty {
  display:none
}
.book {
  font-size: var(--rh-font-size-body-text-lg,1.125rem);
  font-weight: var(--rh-font-weight-body-text-regular,400);
  line-height: 1.6667;
  padding-left: 6rem;
  padding-right: 6rem;
  padding-top: var(--rh-space-3xl,4rem);
  max-width: 1400px;
}

.book[class] h1 code,
.book[class] h2 code,
.book[class] h3 code,
.book[class] h4 code,
.book[class] h5 code,
.book[class] h6 code,
[class] h1 code,
[class] h2 code,
[class] h3 code,
[class] h4 code,
[class] h5 code,
[class] h6 code {
  background:transparent;
  border:0;
  color:inherit;
  font:inherit;
  margin:0;
  padding:0
}
details[class] {
  list-style:none;
  margin:1rem 0 3rem;
  padding:0
}

.preamble {
  margin:0 0 2rem
}
.sect1 {
  margin:2rem 0 1rem
}
:host .sect1,
cp-documentation .sect1 {
  margin:0 0 2rem;
  padding:.0625rem 0 0
}
:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,
:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child {
  margin-top:0
}
.listingblock,
.literalblock {
  margin:1rem 0
}
.quoteblock,
.verseblock {
  border-left:.25rem solid #d2d2d2;
  margin:1rem 0;
  padding:1rem 1rem 1rem 2rem
}
.quoteblock.pullleft,
.verseblock.pullleft {
  float:left;
  margin-right:3rem;
  width:25rem
}
@media (min-width:768px) {
  .quoteblock.pullleft,
  .verseblock.pullleft {
    margin-left:-1rem
  }
}
.quoteblock.pullright,
.verseblock.pullright {
  float:right;
  margin-left:3rem;
  width:25rem
}
@media (min-width:768) {
  .quoteblock.pullright,
  .verseblock.pullright {
    margin-right:-2rem
  }
}
@media (min-width:1100px) {
  .quoteblock.pullright,
  .verseblock.pullright {
    margin-right:-10rem
  }
}
.quoteblock>:first-child,
.verseblock>:first-child {
  margin-top:0
}
.quoteblock .content,
.verseblock .content {
  font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;
  font-size:1.25rem;
  line-height:1.6667
}
.quoteblock .attribution,
.verseblock .attribution {
  font-size:.875rem;
  font-style:italic;
  font-weight:600;
  line-height:1.6667;
  text-transform:uppercase
}
.quoteblock .attribution .citetitle,
.verseblock .attribution .citetitle {
  color:#585858
}
.quoteblock .attribution cite,
.verseblock .attribution cite {
  font-size:1em
}
.quoteblock blockquote {
  font-style:italic;
  margin:0;
  padding:0
}
.quoteblock blockquote .content>:first-child {
  margin-top:0
}
.quoteblock blockquote .content>:first-child:before {
  color:#e00;
  content:"â€œ";
  display:block;
  float:left;
  font-size:2.75rem;
  font-style:normal;
  line-height:1.125em;
  margin-right:.5rem
}
.quoteblock blockquote .content>:first-child .content>:first-child:before {
  content:none
}
.imageblock {
  margin:1rem 0
}
.imageblock.pullleft {
  float:left;
  margin-right:3rem;
  width:25rem
}
@media (min-width:768px) {
  .imageblock.pullleft {
    margin-left:-1rem
  }
}
.imageblock.pullright {
  float:right;
  margin-left:3rem;
  width:25rem
}
@media (min-width:768) {
  .imageblock.pullright {
    margin-right:-2rem
  }
}
@media (min-width:1100px) {
  .imageblock.pullright {
    margin-right:-10rem
  }
}
.imageblock.interrupter {
  margin:2rem 0
}
@media (min-width:768px) {
  .imageblock.interrupter {
    margin-left:-1rem;
    margin-right:-2rem
  }
  .imageblock.interrupter .caption {
    margin-left:1rem;
    margin-right:2rem
  }
}
@media (min-width:1100px) {
  .imageblock.interrupter {
    margin-right:-10rem
  }
  .imageblock.interrupter .caption {
    margin-right:10rem
  }
}
.imageblock.interrupter img {
  max-width:100%
}
.imageblock .caption {
  color:#585858;
  display:block;
  font-size:.875rem;
  line-height:1.6667;
  margin:.5rem 0 0
}
.rhdocs-footnotes {
  border-top:.0625rem solid #d2d2d2;
  margin:3rem 0 1rem;
  padding:1rem 0 0
}
.rhdocs-footnotes>ol {
  margin:0;
  padding:0 0 0 1.5rem
}
@supports (counter-reset:footnotenum) {
  .rhdocs-footnotes>ol {
    counter-reset:footnotenum;
    list-style:none;
    padding:0
  }
  .rhdocs-footnotes>ol>li {
    counter-increment:footnotenum
  }
  .rhdocs-footnotes>ol>li:before {
    color:#585858;
    content:"[" counter(footnotenum) "]";
    display:inline-block;
    margin-right:.25rem
  }
}
#footer {
  background:#ededed;
  color:#151515;
  font-size:.875rem;
  line-height:1.6667;
  margin:3rem 0 0;
  padding:1rem
}
.center {
  margin-left:auto;
  margin-right:auto
}
.stretch {
  width:100%
}

pre,
pre[class] {
  margin:0;
  padding:1.25em 1em;
  position:relative
}
code[class*=language-],
pre[class*=language-] {
  color:#151515;
  -moz-tab-size:4;
  -o-tab-size:4;
  tab-size:4
}
code.language-none,
code.language-text,
code.language-txt,
pre.language-none,
pre.language-text,
pre.language-txt {
  color:#151515
}
code[class*=language-] ::-moz-selection,
code[class*=language-]::-moz-selection,
pre[class*=language-] ::-moz-selection,
pre[class*=language-]::-moz-selection {
  background:#cceae7;
  color:#263238
}
code[class*=language-] ::selection,
code[class*=language-]::selection,
pre[class*=language-] ::selection,
pre[class*=language-]::selection {
  background:#cceae7;
  color:#263238
}
:not(pre)>code[class*=language-] {
  border-radius:.2em;
  padding:.1em;
  white-space:normal
}
.token.atrule {
  color:#40199a
}
.token.attr-name {
  color:#06c
}
.token.attr-value,
.token.attribute {
  color:#b300b3
}
.token.boolean {
  color:#40199a
}
.token.builtin,
.token.cdata,
.token.char,
.token.class,
.token.class-name {
  color:#06c
}
.token.comment {
  color:#6a6e73
}
.token.constant {
  color:#40199a
}
.token.deleted {
  color:#c9190b
}
.token.doctype {
  color:#6a6e73
}
.token.entity {
  color:#c9190b
}
.token.function {
  color:#40199a
}
.token.hexcode {
  color:#b300b3
}
.token.id,
.token.important {
  color:#40199a;
  font-weight:700
}
.token.inserted {
  color:#06c
}
.token.keyword {
  color:#40199a
}
.token.number {
  color:#b300b3
}
.token.operator {
  color:#06c
}
.token.prolog {
  color:#6a6e73
}
.token.property {
  color:#06c
}
.token.pseudo-class,
.token.pseudo-element {
  color:#b300b3
}
.token.punctuation,
.token.regex {
  color:#06c
}
.token.selector {
  color:#c9190b
}
.token.string {
  color:#b300b3
}
.token.symbol {
  color:#40199a
}
.token.unit {
  color:#b300b3
}
.token.url,
.token.variable {
  color:#c9190b
}

@media print {
  .field code,
  .field pre,
  code[class*=language-],
  pre,
  pre[class*=language-] {
    white-space:pre-wrap!important;
    word-wrap:break-word!important;
    overflow-wrap:break-word!important;
    word-break:break-word!important
  }
}

.book>.titlepage:not(:last-child),
.chapter,
section[id] {
  padding-bottom:3.75rem
}
.book>.titlepage .chapter:last-child,
.book>.titlepage section[id]:last-child,
.chapter .chapter:last-child,
.chapter section[id]:last-child,
section[id] .chapter:last-child,
section[id] section[id]:last-child {
  margin-bottom:-3.75rem
}
.listingblock+section[id],
pre+section[id] {
  padding-top:3.75rem
}
.cta-link {
  font-size:inherit
}
a {
  word-wrap:break-word;
  overflow-wrap:break-word
}
.caution,
.important,
.note,
.tip,
.warning {
  padding:.8888888889em;
  position:relative
}
.caution {
  background-color:#fff4cc;
  border-top:2px solid #dca614
}
.important {
  background-color:#fff4cc;
  border-top:2px solid #dca614
}
.note {
  background-color:#e0f0ff;
  border-top:2px solid #4394e5
}
.tip {
  background-color:#e0f0ff;
  border-top:2px solid #4394e5
}
.warning {
  background-color:#fff4cc;
  border-top:2px solid #dca614
}
.book>.titlepage,
.chapter,
section[id] {
  padding-bottom:var(--rh-space-4xl,64px)
}

.titlepage .svg-img[data*="title_logo.svg"] {
  margin:1.5rem 0;
  width:15rem
}
.paragraph {
  margin:1.49963rem 0
}
.paragraph[class] {
  margin-bottom:1.49963rem
}
dd {
  margin-bottom:2.5rem
}

.example {
  border-left:.3125rem solid #ccc;
  margin-bottom:2rem;
  padding:1rem 0 1rem 1rem
}

.annotator-outer[class][class] {
  display:none;
  flex-direction:column;
  flex-grow:1;
  height:auto;
  margin:0;
  position:static;
  width:auto
}
@media (min-width:1400px) {
  .annotator-outer[class][class] {
    display:flex
  }
}

.producttitle {
  color:#000;
  font-size:1.25rem;
  text-transform:uppercase
}
.title {
  font-size:1rem;
  font-style:normal;
  font-weight:700;
  line-height:1.6667;
  margin:1.25rem 0 0;
  text-transform:none
}
.paragraph>.title[class]+.content>:first-child,
.paragraph>.title[class]+p,
p.title[class]+.content>:first-child,
p.title[class]+p {
  margin-top:0
}
[class] pre .caution,
[class] pre .important,
[class] pre .note,
[class] pre .tip,
[class] pre .warning {
  background:transparent;
  border:0;
  color:inherit;
  font:inherit;
  margin:0;
  padding:0
}
[class] pre .caution:after,
[class] pre .important:after,
[class] pre .note:after,
[class] pre .tip:after,
[class] pre .warning:after {
  content:none
}
[class] code.email {
  background-color:transparent;
  font:inherit;
  padding:0
}
[class] .author {
  margin-bottom:1.5rem
}
[class] .author .author {
  margin-bottom:0
}
table {
  margin:2rem 0
}
[class] table {
  width:auto
}
table .table-contents table {
  max-width:100%;
  overflow:auto
}
rh-table table {
  margin:0;
  max-width:9999em;
  overflow:visible
}
td,
th {
  border-left:0;
  padding:.5em 1rem;
  transition:background .25s ease-out
}
td.content--md[class][class],
th.content--md[class][class] {
  min-width:13em
}
td.content--lg[class][class],
th.content--lg[class][class] {
  min-width:20em
}
thead th {
  padding-top:1.5em
}
caption {
  color:currentColor;
  color:var(--pfe-table__caption--Color,currentColor);
  font-weight:700;
  margin-bottom:.5rem;
  margin-top:.5rem;
  text-align:center
}
.revhistory table td,
.revhistory table th {
  border-color:transparent
}
.revhistory table td {
  padding:.625rem .875rem
}
.revhistory table.simplelist {
  margin:0
}
@media print {
  #masthead {
    display:none!important
  }
}
.rh-table--is-full-screen #to-top {
  display:none
}
body {
  --rh-table--maxHeight: calc(100vh - 6.25rem) ;
  color:#151515;
  background-color:white;
  font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);
  font-size:var(--rh-body-copy-lage,1.125rem);
  line-height:1.6667;
  -moz-tab-size:4;
  -o-tab-size:4;
  tab-size:4
}
rh-codeblock::slotted(#content) {
  border-radius:.25rem;
  padding:var (--rh-space-lg,16px)
}
rh-codeblock .screen {
  display:grid;
  grid-template-columns:1fr 4.375rem
}
rh-codeblock[class][class][class][class][class] {
  max-width:99999em
}
pre {
  border:0;
  max-height:-moz-max-content;
  max-height:max-content
}
pre,
pre[class] {
  margin:0;
  padding:1.25em 1em;
  position:relative
}
rh-code-block>div.codeblock__inner-wrapper>pre,
rh-code-block>div.codeblock__inner-wrapper>pre[class] {
  margin:0;
  padding:0;
  position:relative
}
code[class*=language-],
pre[class*=language-] {
  color:#151515;
  -moz-tab-size:4;
  -o-tab-size:4;
  tab-size:4
}
code.literal {
  background:#eee;
  border-radius:.25rem;
  color:#000;
  font-size:.875rem;
  line-height:1.6667;
  overflow-wrap:break-word;
  padding:.125em .5em;
  word-break:break-word
}
code.literal,
kbd,
span.keycap {
  font-family:RedHatMono,Red Hat Mono,Consolas,monospace
}
kbd,
span.keycap {
  background-color:#eee;
  background-image:linear-gradient(180deg,#ddd,#eee,#fff);
  border-radius:.1875rem;
  box-shadow:0 -.0625rem #fff,0 .0625rem 0 .1875rem #aaa;
  font-size:90%;
  font-weight:400;
  margin:0 .25rem;
  padding:.125rem .375rem
}
ol,
ul {
  margin:1rem 0;
  padding:0 0 0 1.5rem
}
._additional-resources[class][class],
._additional-resources[class][class][id]:last-child {
  background:#fff;
  border:.0625rem solid #d2d2d2;
  border-radius:.1875rem;
  margin:2em 0 4em;
  padding:2rem 2rem 1rem
}
._additional-resources[class][class] ul {
  border:0;
  list-style:none;
  margin:0;
  padding:0;
  position:relative
}
._additional-resources[class][class] li {
  border-bottom:.0625rem solid #d2d2d2;
  box-sizing:content-box;
  margin:0;
  padding:1rem 1.5rem 1rem 0;
  -moz-column-break-inside:avoid;
  break-inside:avoid
}
._additional-resources[class][class] li:last-child {
  border:0
}
section.section#additional_resource .additional-resources__heading,
section.section#additional_resource .heading,
section.section#additional_resource h1,
section.section#additional_resource h2,
section.section#additional_resource h3,
section.section#additional_resource h4,
section.section#additional_resource h5,
section.section#additional_resource h6,
section.section#additional_resource p.title {
  display:block;
  font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;
  font-size:1.125rem;
  font-weight:700;
  line-height:1.5rem;
  margin:0 0 .5rem;
  padding:0;
  text-transform:uppercase
}
section.section:first-of-type {
  margin-top:var(--rh-space-4xl,64px)
}
section.section p {
  margin-bottom:var(--rh-space-lg,16px);
  margin-top:0
}


dl {
  display:block;
  margin-block-end:1em;
  margin-block-start:1em;
  margin-inline-end:0;
  margin-inline-start:0
}
.paragraph {
  margin:1.49963rem 0
}
img,
object,
svg {
  display:inline-block;
  max-width:100%;
  vertical-align:middle
}
.titlepage .svg-img[data*="title_logo.svg"] {
  margin:1.5rem 0;
  width:15rem
}
.book[class] .author {
  margin-bottom:1.5rem
}
.book[class] .author .author {
  margin-bottom:0
}
.paragraph>.title[class],
p.title[class] {
  font-size:1rem;
  font-style:normal;
  font-weight:700;
  line-height:1.6667;
  margin:1.25rem 0 0
}
.example {
  border-left:.3125rem solid #ccc;
  margin-bottom:2rem;
  padding:1rem 0 1rem 1rem
}
code {
  background:#eee;
  color:#000;
  font-family:RedHatMono,Red Hat Mono,Consolas,monospace;
  font-size:.875rem;
  line-height:1.6667;
  overflow-wrap:break-word;
  padding:.125em .5em;
  word-break:break-word
}
.paragraph[class] {
  margin-bottom:1.49963rem
}
.book[class] code.email {
  background-color:transparent;
  font:inherit;
  padding:0
}

.producttitle {
  color:#000;
  font-size:1.25rem;
  text-transform:uppercase
}
dl {
  margin:1rem 0
}
dl dt {
  font-weight:600;
  margin:.5rem 0
}
ol ol {
  list-style:lower-roman
}
.codeblock--processed pf-clipboard-copy::part(input),
.codeblock--processed pf-clipboard-copy::part(span) {
  display:none
}
.token.tag {
  color:#c9190b
}

.admonitionblock {
  margin-bottom:var(--rh-space-lg,1rem)
}
.guibutton,
.guimenu,
.guimenuitem {
  font-weight:700
}
.guibutton {
  font-size:90%;
  padding:.1875rem
}
.guibutton:before {
  content:"["
}
.guibutton:after {
  content:"]"
}
.book,
{
  --rh-table--maxHeight: calc(100vh - 6.25rem) ;
  color:#151515;
  font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;
  font-size:1.125rem;
  line-height:1.6667;
  -moz-tab-size:4;
  -o-tab-size:4;
  tab-size:4
}
pre[hidden] {
  display:none
}
.listingblock {
  background:var(--rh-color-surface-lighter,#f2f2f2);
  margin:1rem 0;
  overflow:visible;
  position:relative;
  transform:translate(0);
  z-index:0
}
nopre {
  display:block;
  font-size:.8125rem;
  line-height:1.42857;
  margin:0 0 .625rem;
  word-break:break-all;
  word-wrap:break-word;
  background-color:var(--rh-color-surface-lighter,#f2f2f2);
  border:.0625rem solid #ccc;
  border-radius:.25rem;
  color:#333
}
.book pre,
pre {
  background:var(--rh-color-surface-lighter,#f2f2f2);
  color:#151515;
  font-family:RedHatMono,Red Hat Mono,Consolas,monospace;
  font-size:.875rem;
  line-height:1.6667;
  overflow-wrap:normal;
  white-space:pre;
  word-break:normal
}
pre[class] {
  line-height:1.6667;
  overflow-x:auto
}
*,
:after,
:before {
  box-sizing:border-box
}
:root {
  --rh-space-xs:4px;
  --rh-space-sm:6px;
  --rh-space-md:8px;
  --rh-space-lg:16px;
  --rh-space-xl:24px;
  --rh-space-2xl:32px;
  --rh-space-3xl:48px;
  --rh-space-4xl:64px;
  --rh-space-5xl:80px;
  --rh-space-6xl:96px;
  --rh-space-7xl:128px;
  --rh-font-size-body-text-xs:.75rem;
  --rh-font-size-body-text-sm:.875rem;
  --rh-font-size-body-text-md:1rem;
  --rh-font-size-body-text-lg:1.125rem;
  --rh-font-size-body-text-xl:1.25rem;
  --rh-font-size-body-text-2xl:1.5rem;
  --rh-font-size-heading-xs:1.25rem;
  --rh-font-size-heading-sm:1.5rem;
  --rh-font-size-heading-md:1.75rem;
  --rh-font-size-heading-lg:2.25rem;
  --rh-font-size-heading-xl:2.5rem;
  --rh-font-size-heading-2xl:3rem;
  --pfe-navigation--logo--maxWidth:200px;
  --pfe-navigation__logo--height:40px;
  --pfe-navigation--fade-transition-delay:.5s;
  --pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);
  --pf-global--icon--FontSize--sm:.75rem
}
body,
html {
  font-family:Red Hat Text,sans-serif;
  font-size:var(--rh-font-size-body-text-md,1rem);
  line-height:var(--rh-line-height-body-text,1.5);
}

main {
  line-height:30px
}
section {
  padding-bottom:3rem;
  padding-top:3rem
}
img {
  max-width:100%
}
a {
  color:var(--rh-color-interactive-blue-darker,#06c);
  text-decoration:underline
}
a:hover {
  color:var(--rh-color-interactive-blue-darkest,#004080)
}

@media (min-width:576px) {
  .book {
    max-width:540px
  }
}
@media (min-width:768px) {
  .book {
    max-width:720px
  }
}
@media (min-width:992px) {
  .book {
    max-width:1250px
  }
}
section {
  padding:0
}
.list-unstyled {
  list-style:none;
  padding-left:0
}
.doc-image-link {
  display:inline-block;
  text-decoration:none
}
.admonitionblock{
  margin-bottom:var(--rh-space-lg,1rem)
  font-size:var(--rh-font-size-body-text-md,1rem)
}
.admonitionblock table {
  margin:0;
  border:none;
  width:fit-content
}
.admonitionblock td {
  margin:0;
  border:none;
  display:block
}
.admonitionblock .title {
  margin:0;
  color:#002952;
  font-weight:700
}


</style>
</head>
<body id="title-admin" class="book toc2 toc-left">
<div id="header">
<h1>Administration guide for Red Hat Developer Hub</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#snip-customer-support-info_admin-rhdh">Red Hat Developer Hub support</a></li>
<li><a href="#assembly-add-custom-app-file-openshift_admin-rhdh">Chapter 1. Adding a custom application configuration file to Red Hat OpenShift Container Platform</a>
<ul class="sectlevel2">
<li><a href="#proc-add-custom-app-file-openshift-helm_admin-rhdh">1.1. Adding a custom application configuration file to OpenShift Container Platform using the Helm chart</a></li>
<li><a href="#proc-add-custom-app-config-file-ocp-operator_admin-rhdh">1.2. Adding a custom application configuration file to OpenShift Container Platform using the Operator</a></li>
</ul>
</li>
<li><a href="#enabling-authentication">Chapter 2. Enabling authentication in Red Hat Developer Hub</a>
<ul class="sectlevel2">
<li><a href="#proc-adding-azure-as-an-authentication-provider_admin-rhdh">2.1. Enabling the Microsoft Azure authentication provider</a></li>
<li><a href="#assembly-auth-provider-github">2.2. GitHub authentication provider</a>
<ul class="sectlevel3">
<li><a href="#con-github-app-overview">2.2.1. GitHub App​ overview</a></li>
<li><a href="#proc-registering-github-app">2.2.2. Registering a GitHub​ App</a></li>
<li><a href="#proc-configuring-github-app">2.2.3. Configuring a GitHub App in Developer Hub</a></li>
<li><a href="#proc-adding-github-to-frontend">2.2.4. Adding the GitHub provider to the Developer Hub front end​</a></li>
</ul>
</li>
<li><a href="#assembly-auth-provider-oidc">2.3. OpenID Connect authentication provider</a>
<ul class="sectlevel3">
<li><a href="#con-oidc-configration_admin-rhdh">2.3.1. Overview of using the OIDC authentication provider in Developer Hub</a></li>
<li><a href="#proc-configuring-keycloak-with-oidc_admin-rhdh">2.3.2. Configuring Keycloak with the OIDC authentication provider</a></li>
<li><a href="#proc-migrating-oauth2-proxy-to-oidc_admin-rhdh">2.3.3. Migrating from OAuth2 Proxy with Keycloak to OIDC in Developer Hub</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#assembly-configuring-external-postgresql-databases">Chapter 3. Configuring external PostgreSQL databases</a>
<ul class="sectlevel2">
<li><a href="#proc-configuring-postgresql-instance-using-operator_admin-rhdh">3.1. Configuring an external PostgreSQL instance using the Operator</a></li>
<li><a href="#proc-configuring-postgresql-instance-using-helm_admin-rhdh">3.2. Configuring an external PostgreSQL instance using the Helm Chart</a></li>
<li><a href="#proc-migrating-databases-to-an-external-server_admin-rhdh">3.3. Migrating local databases to an external database server using the Operator</a></li>
</ul>
</li>
<li><a href="#proc-configuring-an-rhdh-instance-with-tls-in-kubernetes_admin-rhdh">Chapter 4. Configuring an RHDH instance with a TLS connection in Kubernetes</a></li>
<li><a href="#assembly-rhdh-telemetry">Chapter 5. Telemetry data collection</a>
<ul class="sectlevel2">
<li><a href="#disabling-telemetry-data-collection_admin-rhdh">5.1. Disabling telemetry data collection in RHDH</a>
<ul class="sectlevel3">
<li><a href="#proc-disabling-telemetry-using-helm_admin-rhdh">5.1.1. Disabling telemetry data collection using the Helm Chart</a></li>
<li><a href="#proc-disabling-telemetry-using-operator_admin-rhdh">5.1.2. Disabling telemetry data collection using the Operator</a></li>
</ul>
</li>
<li><a href="#enabling-telemetry-data-collection_admin-rhdh">5.2. Enabling telemetry data collection in RHDH</a>
<ul class="sectlevel3">
<li><a href="#proc-enabling-telemetry-using-helm_admin-rhdh">5.2.1. Enabling telemetry data collection using the Helm Chart</a></li>
<li><a href="#proc-enabling-telemetry-using-operator_admin-rhdh">5.2.2. Enabling telemetry data collection using the Operator</a></li>
</ul>
</li>
<li><a href="#customizing-telemetry-segment_admin-rhdh">5.3. Customizing telemetry Segment source</a>
<ul class="sectlevel3">
<li><a href="#proc-customizing-telemetry-segment-using-helm_admin-rhdh">5.3.1. Customizing telemetry Segment source using the Helm Chart</a></li>
<li><a href="#proc-customizing-telemetry-segment-using-operator_admin-rhdh">5.3.2. Customizing telemetry Segment source using the Operator</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#assembly-rhdh-observability">Chapter 6. Enabling observability for Red Hat Developer Hub on OpenShift Container Platform</a>
<ul class="sectlevel2">
<li><a href="#proc-admin-enabling-metrics-ocp-helm_assembly-rhdh-observability">6.1. Enabling metrics monitoring in a Helm chart installation on an OpenShift Container Platform cluster</a></li>
<li><a href="#proc-admin-enabling-metrics-ocp-operator_assembly-rhdh-observability">6.2. Enabling metrics monitoring in a Red Hat Developer Hub Operator installation on an OpenShift Container Platform cluster</a></li>
<li><a href="#additional-resources_assembly-rhdh-observability">6.3. Additional resources</a></li>
</ul>
</li>
<li><a href="#assembly-running-rhdh-behind-a-proxy">Chapter 7. Running the RHDH application behind a corporate proxy</a>
<ul class="sectlevel2">
<li><a href="#proc-configuring-proxy-in-helm-deployment_assembly-rhdh-observability">7.1. Configuring proxy information in Helm deployment</a></li>
<li><a href="#proc-configuring-proxy-in-operator-deployment_assembly-rhdh-observability">7.2. Configuring proxy information in Operator deployment</a></li>
</ul>
</li>
<li><a href="#con-rbac-overview_assembly-rhdh-observability">Chapter 8. Role-Based Access Control (RBAC) in Red Hat Developer Hub</a>
<ul class="sectlevel2">
<li><a href="#ref-rbac-permission-policies_assembly-rhdh-observability">8.1. Permission policies in Red Hat Developer Hub</a>
<ul class="sectlevel3">
<li><a href="#con-rbac-config-permission-policies_assembly-rhdh-observability">8.1.1. Permission policies configuration</a>
<ul class="sectlevel4">
<li><a href="#con-rbac-config-permission-policies-admin_assembly-rhdh-observability">Configuration of permission policies administrators</a></li>
<li><a href="#con-rbac-config-permission-policies-external-file_assembly-rhdh-observability">Configuration of permission policies defined in an external file</a>
<ul class="sectlevel5">
<li><a href="#_mounting-policy-csv-file-to-the-developer-hub-helm-chart">Mounting <code>policy.csv</code> file to the Developer Hub Helm chart</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#con-rbac-conditional-policies-rhdh_assembly-rhdh-observability">8.2. Conditional policies in Red Hat Developer Hub</a>
<ul class="sectlevel3">
<li><a href="#ref-rbac-conditional-policy-definition_assembly-rhdh-observability">8.2.1. Conditional policies definition</a>
<ul class="sectlevel4">
<li><a href="#_examples-of-conditional-policies">Examples of conditional policies</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#proc-rbac-ui-manage-roles_assembly-rhdh-observability">8.3. Managing role-based access controls (RBAC) using the Red Hat Developer Hub Web UI</a>
<ul class="sectlevel3">
<li><a href="#proc-rbac-ui-create-role_assembly-rhdh-observability">8.3.1. Creating a role in the Red Hat Developer Hub Web UI</a></li>
<li><a href="#proc-rbac-ui-edit-role_assembly-rhdh-observability">8.3.2. Editing a role in the Red Hat Developer Hub Web UI</a></li>
<li><a href="#proc-rbac-ui-delete-role_assembly-rhdh-observability">8.3.3. Deleting a role in the Red Hat Developer Hub Web UI</a></li>
</ul>
</li>
<li><a href="#con-rbac-rest-api_assembly-rhdh-observability">8.4. Role-based Access Control (RBAC) REST API</a>
<ul class="sectlevel3">
<li><a href="#proc-rbac-send-request-rbac-rest-api_assembly-rhdh-observability">8.4.1. Sending requests with the RBAC REST API using a REST client or curl utility</a></li>
<li><a href="#ref-rbac-rest-api-endpoints_assembly-rhdh-observability">8.4.2. Supported RBAC REST API endpoints</a>
<ul class="sectlevel4">
<li><a href="#_roles">Roles</a></li>
<li><a href="#_permission-policies">Permission policies</a></li>
<li><a href="#_conditional-policies">Conditional policies</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#assembly-admin-templates">Chapter 9. Managing templates</a>
<ul class="sectlevel2">
<li><a href="#proc-creating-templates_assembly-admin-templates">9.1. Creating a template by using the Template Editor</a></li>
<li><a href="#ref-creating-templates_assembly-admin-templates">9.2. Creating a template as a YAML file</a></li>
<li><a href="#proc-adding-templates_assembly-admin-templates">9.3. Importing an existing template to Red Hat Developer Hub</a></li>
</ul>
</li>
<li><a href="#assembly-techdocs-plugin_assembly-admin-templates">Chapter 10. Configuring the TechDocs plugin in Red Hat Developer Hub</a>
<ul class="sectlevel2">
<li><a href="#con-techdocs-configure-storage_assembly-admin-templates">10.1. Configuring storage for TechDocs files</a>
<ul class="sectlevel3">
<li><a href="#proc-techdocs-using-odf-storage_assembly-admin-templates">10.1.1. Using OpenShift Data Foundation for file storage</a></li>
<li><a href="#proc-techdocs-configure-odf-helm_assembly-admin-templates">10.1.2. Making object storage accessible to containers by using the Helm chart</a>
<ul class="sectlevel4">
<li><a href="#ref-techdocs-example-config-plugin-helm_assembly-admin-templates">Example TechDocs Plugin configuration for the Helm chart</a></li>
</ul>
</li>
<li><a href="#proc-techdocs-configure-odf-operator_assembly-admin-templates">10.1.3. Making object storage accessible to containers by using the Operator</a>
<ul class="sectlevel4">
<li><a href="#ref-techdocs-example-config-plugin-operator_assembly-admin-templates">Example TechDocs Plugin configuration for the Operator</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#con-techdocs-config-cicd_assembly-admin-templates">10.2. Configuring CI/CD to generate and publish TecDocs sites</a>
<ul class="sectlevel3">
<li><a href="#proc-techdocs-config-cicd-prep-repo_assembly-admin-templates">10.2.1. Preparing your repository for CI</a></li>
<li><a href="#proc-techdocs-generate-site_assembly-admin-templates">10.2.2. Generating the TechDocs site</a></li>
<li><a href="#proc-techdocs-publish-site_assembly-admin-templates">10.2.3. Publishing the TechDocs site</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat Developer Hub is an enterprise-grade, open developer platform that you can use to build developer portals. This platform contains a supported and opinionated framework that helps reduce the friction and frustration of developers while boosting their productivity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="snip-customer-support-info_admin-rhdh">Red Hat Developer Hub support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you experience difficulty with a procedure described in this documentation, visit the <a href="http://access.redhat.com">Red Hat Customer Portal</a>. You can use the Red Hat Customer Portal for the following purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To search or browse through the Red Hat Knowledgebase of technical support articles about Red Hat products.</p>
</li>
<li>
<p>To create a <a href="https://access.redhat.com/support/cases/#/case/new/get-support?caseCreate=true">support case</a> for Red Hat Global Support Services (GSS). For support case creation, select <strong>Red Hat Developer Hub</strong> as the product and select the appropriate product version.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-add-custom-app-file-openshift_admin-rhdh">Chapter 1. Adding a custom application configuration file to Red Hat OpenShift Container Platform</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To access the Red Hat Developer Hub, you must add a custom application configuration file to Red Hat OpenShift Container Platform. In OpenShift Container Platform, you can use the following content as a base template to create a ConfigMap named <code>app-config-rhdh</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  app-config-rhdh.yaml: |
    app:
      title: {product}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add the custom application configuration file to OpenShift Container Platform in one of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Red Hat Developer Hub Operator</p>
</li>
<li>
<p>The Red Hat Developer Hub Helm chart.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="proc-add-custom-app-file-openshift-helm_admin-rhdh">1.1. Adding a custom application configuration file to OpenShift Container Platform using the Helm chart</h3>
<div class="paragraph">
<p>You can use the Red Hat Developer Hub Helm chart to add a custom application configuration file to your OpenShift Container Platform instance.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created an Red Hat OpenShift Container Platform account.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>From the OpenShift Container Platform web console, select the <strong>ConfigMaps</strong> tab.</p>
</li>
<li>
<p>Click <strong>Create ConfigMap</strong>.</p>
</li>
<li>
<p>From <strong>Create ConfigMap</strong> page, select the <strong>YAML view</strong> option in <strong>Configure via</strong> and make changes to the file, if needed.</p>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Go to the <strong>Helm</strong> tab to see the list of Helm releases.</p>
</li>
<li>
<p>Click the overflow menu on the Helm release that you want to use and select <strong>Upgrade</strong>.</p>
</li>
<li>
<p>Use either the <strong>Form view</strong> or <strong>YAML view</strong> to edit the Helm configuration.</p>
<div class="ulist">
<ul>
<li>
<p>Using <strong>Form view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Expand <strong>Root Schema → Backstage chart schema → Backstage parameters → Extra app configuration files to inline into command arguments</strong>.</p>
</li>
<li>
<p>Click the <strong>Add Extra app configuration files to inline into command arguments</strong> link.</p>
</li>
<li>
<p>Enter the value in the following fields:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>configMapRef</strong>: <code>app-config-rhdh</code></p>
</li>
<li>
<p><strong>filename</strong>: <code>app-config-rhdh.yaml</code></p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using <strong>YAML view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the value of the <code>upstream.backstage.extraAppConfig.configMapRef</code> and <code>upstream.backstage.extraAppConfig.filename</code> parameters as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ... other Red Hat Developer Hub Helm Chart configurations
upstream:
  backstage:
    extraAppConfig:
      - configMapRef: app-config-rhdh
        filename: app-config-rhdh.yaml
# ... other Red Hat Developer Hub Helm Chart configurations</code></pre>
</div>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-add-custom-app-config-file-ocp-operator_admin-rhdh">1.2. Adding a custom application configuration file to OpenShift Container Platform using the Operator</h3>
<div class="paragraph">
<p>A custom application configuration file is a <code>ConfigMap</code> object that you can use to change the configuration of your Red Hat Developer Hub instance. If you are deploying your Developer Hub instance on Red Hat OpenShift Container Platform, you can use the Red Hat Developer Hub Operator to add a custom application configuration file to your OpenShift Container Platform instance by creating the <code>ConfigMap</code> object and referencing it in the Developer Hub custom resource (CR).</p>
</div>
<div class="paragraph">
<p>The custom application configuration file contains a sensitive environment variable, named <code>BACKEND_SECRET</code>. This variable contains a mandatory backend authentication key that Developer Hub uses to reference an environment variable defined in an OpenShift Container Platform secret. You must create a secret, named 'secrets-rhdh', and reference it in the Developer Hub CR.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You are responsible for protecting your Red Hat Developer Hub installation from external and unauthorized access. Manage the backend authentication key like any other secret. Meet strong password requirements, do not expose it in any configuration files, and only inject it into configuration files as an environment variable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an active Red Hat OpenShift Container Platform account.</p>
</li>
<li>
<p>Your administrator has installed the Red Hat Developer Hub Operator in OpenShift Container Platform. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/administration_guide_for_red_hat_developer_hub/index">Installing the Red Hat Developer Hub Operator</a>.</p>
</li>
<li>
<p>You have created the Red Hat Developer Hub CR in OpenShift Container Platform.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>From the <strong>Developer</strong> perspective in the OpenShift Container Platform web console, select the <strong>Topology</strong> view, and click the <strong>Open URL</strong> icon on the Developer Hub pod to identify your Developer Hub external URL: <em>&lt;RHDH_URL&gt;</em>.</p>
</li>
<li>
<p>From the <strong>Developer</strong> perspective in the OpenShift Container Platform web console, select the <strong>ConfigMaps</strong> view.</p>
</li>
<li>
<p>Click <strong>Create ConfigMap</strong>.</p>
</li>
<li>
<p>Select the <strong>YAML view</strong> option in <strong>Configure via</strong> and use the following example as a base template to create a <code>ConfigMap</code> object, such as <code>app-config-rhdh.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  "app-config-rhdh.yaml": |
    app:
      title: Red Hat Developer Hub
      baseUrl: &lt;RHDH_URL&gt; # <b class="conum">(1)</b>
    backend:
      auth:
        keys:
          - secret: "${BACKEND_SECRET}" # <b class="conum">(2)</b>
      baseUrl: &lt;RHDH_URL&gt; # <b class="conum">(3)</b>
      cors:
        origin: &lt;RHDH_URL&gt; # <b class="conum">(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set the external URL of your Red Hat Developer Hub instance.</p>
</li>
<li>
<p>Use an environment variable exposing an OpenShift Container Platform secret to define the mandatory Developer Hub backend authentication key.</p>
</li>
<li>
<p>Set the external URL of your Red Hat Developer Hub instance.</p>
</li>
<li>
<p>Set the external URL of your Red Hat Developer Hub instance.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Select the <strong>Secrets</strong> view.</p>
</li>
<li>
<p>Click <strong>Create Key/value Secret</strong>.</p>
</li>
<li>
<p>Create a secret named <code>secrets-rhdh</code>.</p>
</li>
<li>
<p>Add a key named <code>BACKEND_SECRET</code> and a base64 encoded string as a value. Use a unique value for each Red Hat Developer Hub instance. For example, you can use the following command to generate a key from your terminal:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">node -p 'require("crypto").randomBytes(24).toString("base64")'</code></pre>
</div>
</div>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Select the <strong>Topology</strong> view.</p>
</li>
<li>
<p>Click the overflow menu for the Red Hat Developer Hub instance that you want to use and select <strong>Edit Backstage</strong> to load the YAML view of the Red Hat Developer Hub instance.</p>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/operator-install-2.png" alt="operator install 2">
</div>
</div>
</li>
<li>
<p>In the CR, enter the name of the custom application configuration config map as the value for the <code>spec.application.appConfig.configMaps</code> field, and enter the name of your secret as the value for the <code>spec.application.extraEnvs.secrets</code> field. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: example
spec:
  application:
    appConfig:
      mountPath: /opt/app-root/src
      configMaps:
         - name: app-config-rhdh
    extraEnvs:
      secrets:
         - name: secrets-rhdh
    extraFiles:
      mountPath: /opt/app-root/src
    replicas: 1
    route:
      enabled: true
  database:
    enableLocalDb: true</code></pre>
</div>
</div>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
<li>
<p>Navigate back to the <strong>Topology</strong> view and wait for the Red Hat Developer Hub pod to start.</p>
</li>
<li>
<p>Click the <strong>Open URL</strong> icon to use the Red Hat Developer Hub platform with the configuration changes.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more information about roles and responsibilities in Developer Hub, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/administration_guide_for_red_hat_developer_hub/index">Role-Based Access Control (RBAC) in Red Hat Developer Hub</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-authentication">Chapter 2. Enabling authentication in Red Hat Developer Hub</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authentication within Red Hat Developer Hub facilitates user sign-in, identification, and access to external resources.
It supports multiple authentication providers.</p>
</div>
<div class="paragraph">
<p>Authentication providers are typically used in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One provider for sign-in and identification.</p>
</li>
<li>
<p>Additional providers for accessing external resources.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Red Hat Developer Hub supports the following authentication providers:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Microsoft Azure</dt>
<dd>
<p><code>microsoft</code></p>
</dd>
<dt class="hdlist1">GitHub</dt>
<dd>
<p><code>github</code></p>
</dd>
<dt class="hdlist1">Keycloak</dt>
<dd>
<p><code>oidc</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For each provider that you want to use, follow the dedicated procedure to complete the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set up the shared secret that the authentication provider and Red Hat Developer Hub require to communicate.</p>
</li>
<li>
<p>Configure Red Hat Developer Hub to use the authentication provider.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="proc-adding-azure-as-an-authentication-provider_admin-rhdh">2.1. Enabling the Microsoft Azure authentication provider</h3>
<div class="paragraph">
<p>Red Hat Developer Hub includes a Microsoft Azure authentication provider that can authenticate users by using OAuth.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To allow Developer Hub to authenticate with Microsoft Azure, create an OAuth Application in Microsoft Azure.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Go to <a href="https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationsListBlade"><strong>Azure Portal &gt; App registrations</strong></a>, and create an <strong>App Registration</strong> for Developer Hub.</p>
</li>
<li>
<p>On your <strong>App registration</strong> overview page, add a new <strong>Web platform configuration</strong>, with the configuration:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Redirect URI</strong></dt>
<dd>
<p>Enter the backend authentication URI set in Developer Hub: <code>https://<em>&lt;APP_FQDN&gt;</em>/api/auth/microsoft/handler/frame</code></p>
</dd>
<dt class="hdlist1"><strong>Front-channel logout URL</strong></dt>
<dd>
<p>Leave blank.</p>
</dd>
<dt class="hdlist1"><strong>Implicit grant and hybrid flows</strong></dt>
<dd>
<p>Leave all checkboxes cleared.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>On the <strong>API permissions</strong> tab, click <strong>Add Permission</strong>, then add the following <strong>Delegated permission</strong> for the
<strong>Microsoft Graph API</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>email</code></dt>
<dt class="hdlist1"><code>offline_access</code></dt>
<dt class="hdlist1"><code>openid</code></dt>
<dt class="hdlist1"><code>profile</code></dt>
<dt class="hdlist1"><code>User.Read</code></dt>
<dt class="hdlist1">(Optional)</dt>
<dd>
<p>Optional custom scopes of the Microsoft Graph API that you define both here and in the Developer Hub configuration (<code>app-config-rhdh.yaml</code>).</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Your company might require you to grant admin consent for these permissions.
Even if your company does not require admin consent, you might do so as it means users do not need to individually consent the first time they access backstage.
To grant admin consent, a directory admin must go to the <a href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/user-admin-consent-overview">admin consent</a> page and click <strong>Grant admin consent for COMPANY NAME</strong>.
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Go to the <strong>Certificates &amp; Secrets</strong> page, then the <strong>Client secrets</strong> tab, and create a new client secret.
Save the <strong>Client secret</strong> for the next step.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add your Microsoft Azure credentials in your Developer Hub secrets.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Edit your Developer Hub secrets, such as <code>secrets-rhdh</code>.</p>
</li>
<li>
<p>Add the following key/value pairs:</p>
<div class="ulist">
<ul>
<li>
<p><code>AUTH_AZURE_CLIENT_ID</code>: Enter the <strong>Application ID</strong> that you generated on Microsoft Azure.</p>
</li>
<li>
<p><code>AUTH_AZURE_CLIENT_SECRET</code>: Enter the <strong>Client secret</strong> that you generated on Microsoft Azure.</p>
</li>
<li>
<p><code>AUTH_AZURE_TENANT_ID</code>: Enter your <strong>Tenant ID</strong> on Microsoft Azure.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set up the Microsoft Azure authentication provider in your Developer Hub custom configuration.</p>
<div class="paragraph">
<p>Edit your custom Developer Hub config map, such as <code>app-config-rhdh</code>.</p>
</div>
<div class="paragraph">
<p>In the <code>app-config-rhdh.yaml</code> content, add the <code>microsoft</code> provider configuration under the root <code>auth</code> configuration, and enable the <code>microsoft</code> provider for sign-in:</p>
</div>
<div class="listingblock">
<div class="title"><code>app-config-rhdh.yaml</code> fragment</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
  environment: production
  providers:
    microsoft:
      production:
        clientId: ${AUTH_AZURE_CLIENT_ID}
        clientSecret: ${AUTH_AZURE_CLIENT_SECRET}
        tenantId: ${AUTH_AZURE_TENANT_ID}
        # domainHint: ${AUTH_AZURE_TENANT_ID} # <b class="conum">(1)</b>
        # additionalScopes: # <b class="conum">(2)</b>
          # - Mail.Send
signInPage: microsoft # <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Optional for single-tenant applications. You can reduce login friction for users with accounts in multiple tenants by automatically filtering out accounts from other tenants. If you want to use this parameter for a single-tenant application, uncomment and enter the tenant ID. If your application registration is multi-tenant, leave this parameter blank. For more information, see <a href="https://learn.microsoft.com/en-us/azure/active-directory/manage-apps/home-realm-discovery-policy">Home Realm Discovery</a>.</p>
</li>
<li>
<p>Optional for additional scopes. To add scopes for the application registration, uncomment and enter the list of scopes that you want to add.
The default and mandatory value is <code>['user.read']</code>.</p>
</li>
<li>
<p>To enable the Microsoft Azure provider as default sign-in provider.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Optional for environments with restrictions on outgoing access, such as firewall rules. If your environment has outgoing access restrictions make sure your Backstage backend has access to the following hosts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>login.microsoftonline.com</code>: To get and exchange authorization codes and access tokens.</p>
</li>
<li>
<p><code>graph.microsoft.com</code>: To fetch user profile information (as seen in this source code).
If this host is unreachable, users might see an <em>Authentication failed, failed to fetch user profile</em> error when they attempt to log in.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="assembly-auth-provider-github">2.2. GitHub authentication provider</h3>
<div class="paragraph">
<p>Red Hat Developer Hub uses a built-in GitHub authentication provider to authenticate users in GitHub or GitHub Enterprise.</p>
</div>
<div class="sect3">
<h4 id="con-github-app-overview">2.2.1. GitHub App​ overview</h4>
<div class="paragraph">
<p>GitHub Apps are generally preferred to OAuth apps because they use fine-grained permissions, give more control over which repositories the application can access, and use short-lived tokens. For more information, see <a href="https://docs.github.com/en/apps/overview">GitHub Apps overview</a> in the GitHub documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-registering-github-app">2.2.2. Registering a GitHub​ App</h4>
<div class="paragraph">
<p>In a GitHub App, you configure the allowed scopes as part of that application, therefore, you must verify the scope that your plugins require. The scope information is available in the plugin README files.</p>
</div>
<div class="paragraph">
<p>To add GitHub authentication, complete the steps in <a href="https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/registering-a-github-app">Registering a GitHub App</a> on the GitHub website.</p>
</div>
<div class="paragraph">
<p>Use the following examples to enter the information about your production environment into the required fields on the <strong>Register new GitHub App</strong> page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Application name: Red Hat Developer Hub</p>
</li>
<li>
<p>Homepage URL:  <code>https://developer-hub-&lt;NAMESPACE_NAME&gt;.&lt;KUBERNETES_ROUTE_HOST&gt;</code></p>
</li>
<li>
<p>Authorization callback URL: <code>https://developer-hub-&lt;NAMESPACE_NAME&gt;.&lt;KUBERNETES_ROUTE_HOST&gt;/api/auth/github/handler/frame</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Homepage URL points to the Developer Hub front end, while the authorization callback URL points to the authentication provider backend.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="proc-configuring-github-app">2.2.3. Configuring a GitHub App in Developer Hub</h4>
<div class="paragraph">
<p>To add GitHub authentication for Developer Hub, you must configure the GitHub App in your <code>app-config.yaml</code> file.</p>
</div>
<div class="paragraph">
<p>The GitHub authentication provider uses the following configuration keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>clientId</code>: the client ID that you generated on GitHub. For example: b59241722e3c3b4816e2</p>
</li>
<li>
<p><code>clientSecret</code>: the client secret tied to the generated client ID.</p>
</li>
<li>
<p><code>enterpriseInstanceUrl</code> (optional): the base URL for a GitHub Enterprise instance. For example: <code>https://ghe.&lt;company&gt;.com</code>. The <code>enterpriseInstanceUrl</code> is only needed for GitHub Enterprise.</p>
</li>
<li>
<p><code>callbackUrl</code> (optional): the callback URL that GitHub uses when initiating an OAuth flow. For example: https://your-intermediate-service.com/handler. The <code>callbackUrl</code> is only needed if Developer Hub is not the immediate receiver, such as in cases when you use one OAuth app for many Developer Hub instances.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the GitHub App, add the provider configuration to your <code>app-config.yaml</code> file under the root auth configuration. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
 environment: production
 providers:
   github:
     production:
       clientId: ${GITHUB_APP_CLIENT_ID}
       clientSecret: ${GITHUB_APP_CLIENT_SECRET}
       ## uncomment if using GitHub Enterprise
       # enterpriseInstanceUrl: ${GITHUB_URL}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-adding-github-to-frontend">2.2.4. Adding the GitHub provider to the Developer Hub front end​</h4>
<div class="paragraph">
<p>To add the provider to the front end, add the sign in configuration to your <code>app-config.yaml</code> file. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">signInPage: github</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For information about authenticating Backstage access with GitHub, see <a href="https://backstage.io/docs/integrations/github/github-apps/">GitHub Authentication Provider</a> in the community documentation.</p>
</li>
<li>
<p>For information about adding the provider to the Backstage front end, see <a href="https://github.com/janus-idp/backstage-showcase/blob/main/showcase-docs/getting-started.md">Enabling authentication in Showcase</a> in the community documentation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="assembly-auth-provider-oidc">2.3. OpenID Connect authentication provider</h3>
<div class="paragraph">
<p>Red Hat Developer Hub uses the OpenID Connect (OIDC) authentication provider to authenticate with third-party services that support the OIDC protocol.</p>
</div>
<div class="sect3">
<h4 id="con-oidc-configration_admin-rhdh">2.3.1. Overview of using the OIDC authentication provider in Developer Hub</h4>
<div class="paragraph">
<p>You can configure the OIDC authentication provider in Developer Hub by updating your <code>app-config.yaml</code> file under the root auth configuration. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
  environment: production
  # Providing an auth.session.secret will enable session support in the auth-backend
  session:
    secret: ${SESSION_SECRET}
  providers:
    oidc:
      production:
        metadataUrl: ${AUTH_OIDC_METADATA_URL}
        clientId: ${AUTH_OIDC_CLIENT_ID}
        clientSecret: ${AUTH_OIDC_CLIENT_SECRET}
        prompt: ${AUTH_OIDC_PROMPT} # Recommended to use auto
        ## Uncomment for additional configuration options
        # callbackUrl: ${AUTH_OIDC_CALLBACK_URL}
        # tokenEndpointAuthMethod: ${AUTH_OIDC_TOKEN_ENDPOINT_METHOD}
        # tokenSignedResponseAlg: ${AUTH_OIDC_SIGNED_RESPONSE_ALG}
        # scope: ${AUTH_OIDC_SCOPE}
        ## Declarative resolvers to override the default resolver: `emailLocalPartMatchingUserEntityName`
        ## The authentication provider tries each sign-in resolver until it succeeds, and fails if none succeed. Uncomment the resolvers that you want to use.
        # signIn:
        #   resolvers:
        #     - resolver: preferredUsernameMatchingUserEntityName
        #     - resolver: emailMatchingUserEntityProfileEmail
        #     - resolver: emailLocalPartMatchingUserEntityName
signInPage: oidc</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-configuring-keycloak-with-oidc_admin-rhdh">2.3.2. Configuring Keycloak with the OIDC authentication provider</h4>
<div class="paragraph">
<p>Red Hat Developer Hub includes an OIDC authentication provider that can authenticate users by using Keycloak.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The user that you create in Keycloak must also be available in the Developer Hub catalog.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In Keycloak, create a new realm, for example <code>RHDH</code>.</p>
</li>
<li>
<p>Add a new user.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Username</strong></dt>
<dd>
<p>Username for the user, for example: <code>rhdhuser</code></p>
</dd>
<dt class="hdlist1"><strong>Email</strong></dt>
<dd>
<p>Email address of the user.</p>
</dd>
<dt class="hdlist1"><strong>First name</strong></dt>
<dd>
<p>First name of the user.</p>
</dd>
<dt class="hdlist1"><strong>Last name</strong></dt>
<dd>
<p>Last name of the user.</p>
</dd>
<dt class="hdlist1"><strong>Email verified</strong></dt>
<dd>
<p>Toggle to <strong>On</strong>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Navigate to the <strong>Credentials</strong> tab.</p>
</li>
<li>
<p>Click <strong>Set password</strong>.</p>
</li>
<li>
<p>Enter the <strong>Password</strong> for the user account and toggle <strong>Temporary</strong> to <strong>Off</strong>.</p>
</li>
<li>
<p>Create a new Client ID, for example, <code>RHDH</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Client authentication</strong></dt>
<dd>
<p>Toggle to <strong>On</strong>.</p>
</dd>
<dt class="hdlist1"><strong>Valid redirect URIs</strong></dt>
<dd>
<p>Set to the OIDC handler URL, for example, <code><a href="https://&lt;RHDH_URL&gt;/api/auth/oidc/handler/frame" class="bare">https://&lt;RHDH_URL&gt;/api/auth/oidc/handler/frame</a></code>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Navigate to the <strong>Credentials</strong> tab and copy the <strong>Client secret</strong>.</p>
</li>
<li>
<p>Save the Client ID and the Client Secret for the next step.</p>
</li>
<li>
<p>In Developer Hub, add your Keycloak credentials in your Developer Hub secrets.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Edit your Developer Hub secrets, such as secrets-rhdh.</p>
</li>
<li>
<p>Add the following key/value pairs:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>AUTH_KEYCLOAK_CLIENT_ID</code></dt>
<dd>
<p>Enter the Client ID that you generated in Keycloak, such as <code>RHDH</code>.</p>
</dd>
<dt class="hdlist1"><code>AUTH_KEYCLOAK_CLIENT_SECRET</code></dt>
<dd>
<p>Enter the Client Secret that you generated in Keycloak.</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Set up the OIDC authentication provider in your Developer Hub custom configuration.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Edit your custom Developer Hub ConfigMap, such as <code>app-config-rhdh</code>.</p>
</li>
<li>
<p>In the <code>app-config-rhdh.yaml</code> content, add the <code>oidc</code> provider configuration under the root <code>auth</code> configuration, and enable the <code>oidc</code> provider for sign-in:</p>
<div class="listingblock">
<div class="title"><code>app-config-rhdh.yaml</code> fragment</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
  environment: production
  providers:
    oidc:
      production:
      clientId: ${AUTH_KEYCLOAK_CLIENT_ID}
      clientSecret: ${AUTH_KEYCLOAK_CLIENT_SECRET}
      metadataUrl: ${KEYCLOAK_BASE_URL}/auth/realms/${KEYCLOAK_REALM}
      prompt: ${KEYCLOAK_PROMPT} # recommended to use auto
      <mark> Uncomment for additional configuration options
      #callbackUrl: ${KEYCLOAK_CALLBACK_URL}
      #tokenEndpointAuthMethod: ${KEYCLOAK_TOKEN_ENDPOINT_METHOD}
      #tokenSignedResponseAlg: ${KEYCLOAK_SIGNED_RESPONSE_ALG}
      #scope: ${KEYCLOAK_SCOPE}
      </mark> If you are using the keycloak-backend plugin, use the <code>preferredUsernameMatchingUserEntityName</code> resolver to avoid a login error.
      signIn:
        resolvers:
          - resolver: preferredUsernameMatchingUserEntityName
signInPage: oidc</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Restart your <code>backstage-developer-hub</code> application to apply the changes.</p>
</li>
<li>
<p>Your Developer Hub sign-in page displays <strong>Sign in using OIDC</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-migrating-oauth2-proxy-to-oidc_admin-rhdh">2.3.3. Migrating from OAuth2 Proxy with Keycloak to OIDC in Developer Hub</h4>
<div class="paragraph">
<p>If you are using OAuth2 Proxy as an authentication provider with Keycloak, and you want to migrate to OIDC, you can update your authentication provider configuration to use OIDC.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In Keycloak, update the valid redirect URI to <code><a href="https://&lt;rhdh_url&gt;/api/auth/oidc/handler/frame" class="bare">https://&lt;rhdh_url&gt;/api/auth/oidc/handler/frame</a></code>. Make sure to replace <code>&lt;rhdh_url&gt;</code> with your Developer Hub application URL, such as, <code>my.rhdh.example.com</code>.</p>
</li>
<li>
<p>Replace the <code>oauth2Proxy</code> configuration values in the <code>auth</code> section of your <code>app-config.yaml</code> file with the <code>oidc</code> configuration values.</p>
</li>
<li>
<p>Update the <code>signInPage</code> configuration value from <code>oauth2Proxy</code> to <code>oidc</code>.</p>
<div class="paragraph">
<p>The following example shows the <code>auth.providers</code> and <code>signInPage</code> configuration for <code>oauth2Proxy</code> prior to migrating the authentication provider to <code>oidc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
  environment: production
  session:
    secret: ${SESSION_SECRET}
  providers:
    oauth2Proxy: {}
signInPage: oauth2Proxy</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows the <code>auth.providers</code> and <code>signInPage</code> configuration after migrating the authentication provider to <code>oidc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">auth:
  environment: production
  session:
    secret: ${SESSION_SECRET}
  providers:
    oidc:
      production:
        metadataUrl: ${KEYCLOAK_METADATA_URL}
        clientId: ${KEYCLOAK_CLIENT_ID}
        clientSecret: ${KEYCLOAK_CLIENT_SECRET}
        prompt: ${KEYCLOAK_PROMPT} # recommended to use auto
signInPage: oidc</code></pre>
</div>
</div>
</li>
<li>
<p>Remove the OAuth2 Proxy sidecar container and update the <code>upstream.service</code> section of your Helm chart’s <code>values.yaml</code> file as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>service.ports.backend</code>: <code>7007</code></p>
</li>
<li>
<p><code>service.ports.targetPort</code>: <code>backend</code></p>
<div class="paragraph">
<p>The following example shows the <code>service</code> configuration for <code>oauth2Proxy</code> prior to migrating the authentication provider to <code>oidc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">service:
  ports:
    name: http-backend
    backend: 4180
    targetPort: oauth2Proxy</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows the <code>service</code> configuration after migrating the authentication provider to <code>oidc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">service:
  ports:
    name: http-backend
    backend: 7007
    targetPort: backend</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Upgrade the Developer Hub Helm chart.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-configuring-external-postgresql-databases">Chapter 3. Configuring external PostgreSQL databases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an administrator, you can configure and use external PostgreSQL databases in Red Hat Developer Hub. You can use a PostgreSQL certificate file to configure an external PostgreSQL instance using the Operator or Helm Chart.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Developer Hub supports only configuring external PostgreSQL databases. You can perform maintenance activities, such as backing up your data or configuring high availability (HA) for the external PostgreSQL databases.</p>
</div>
<div class="paragraph">
<p>Also, configuring an external PostgreSQL instance by using the Red Hat Developer Hub Operator or Helm Chart is not intended for production use.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="proc-configuring-postgresql-instance-using-operator_admin-rhdh">3.1. Configuring an external PostgreSQL instance using the Operator</h3>
<div class="paragraph">
<p>You can configure an external PostgreSQL instance using the Red Hat Developer Hub Operator. By default, the Operator creates and manages a local instance of PostgreSQL in the same namespace where you have deployed the RHDH instance. However, you can change this default setting to configure an external PostgreSQL database server, for example, Amazon Web Services (AWS) Relational Database Service (RDS) or Azure database.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You are using a supported version of PostgreSQL. For more information, see the <a href="https://access.redhat.com/support/policy/updates/developerhub">Product life cycle page</a>.</p>
</li>
<li>
<p>You have the following details:</p>
<div class="ulist">
<ul>
<li>
<p><code>db-host</code>: Denotes your PostgreSQL instance Domain Name System (DNS) or IP address</p>
</li>
<li>
<p><code>db-port</code>: Denotes your PostgreSQL instance port number, such as <code>5432</code></p>
</li>
<li>
<p><code>username</code>: Denotes the user name to connect to your PostgreSQL instance</p>
</li>
<li>
<p><code>password</code>: Denotes the password to connect to your PostgreSQL instance</p>
</li>
</ul>
</div>
</li>
<li>
<p>You have installed the Red Hat Developer Hub Operator.</p>
</li>
<li>
<p>Optional: You have a CA certificate, Transport Layer Security (TLS) private key, and TLS certificate so that you can secure your database connection by using the TLS protocol. For more information, refer to your PostgreSQL vendor documentation.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, Developer Hub uses a database for each plugin and automatically creates it if none is found. You might need the <code>Create Database</code> privilege in addition to <code>PSQL Database</code> privileges for configuring an external PostgreSQL instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Optional: Create a certificate secret to configure your PostgreSQL instance with a TLS connection:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;crt-secret&gt; <b class="conum">(1)</b>
type: Opaque
stringData:
 postgres-ca.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;ca-certificate-key&gt; <b class="conum">(2)</b>
 postgres-key.key: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-private-key&gt; <b class="conum">(3)</b>
 postgres-crt.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-certificate-key&gt; <b class="conum">(4)</b>
  # ...
EOF</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Provide the name of the certificate secret.</p>
</li>
<li>
<p>Provide the CA certificate key.</p>
</li>
<li>
<p>Optional: Provide the TLS private key.</p>
</li>
<li>
<p>Optional: Provide the TLS certificate key.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a credential secret to connect with the PostgreSQL instance:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;cred-secret&gt; <b class="conum">(1)</b>
type: Opaque
stringData: <b class="conum">(2)</b>
 POSTGRES_PASSWORD: &lt;password&gt;
 POSTGRES_PORT: "&lt;db-port&gt;"
 POSTGRES_USER: &lt;username&gt;
 POSTGRES_HOST: &lt;db-host&gt;
 PGSSLMODE: &lt;ssl-mode&gt; # for TLS connection <b class="conum">(3)</b>
 NODE_EXTRA_CA_CERTS: &lt;abs-path-to-pem-file&gt; # for TLS connection, e.g. /opt/app-root/src/postgres-crt.pem <b class="conum">(4)</b>
EOF</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Provide the name of the credential secret.</p>
</li>
<li>
<p>Provide credential data to connect with your PostgreSQL instance.</p>
</li>
<li>
<p>Optional: Provide the value based on the required <a href="https://www.postgresql.org/docs/15/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">Secure Sockets Layer (SSL) mode</a>.</p>
</li>
<li>
<p>Optional: Provide the value only if you need a TLS connection for your PostgreSQL instance.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a <code>Backstage</code> custom resource (CR):</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: rhdh.redhat.com/v1alpha1
kind: Backstage
metadata:
  name: &lt;backstage-instance-name&gt;
spec:
  database:
    enableLocalDb: false <b class="conum">(1)</b>
  application:
    extraFiles:
      mountPath: &lt;path&gt; # e g /opt/app-root/src
      secrets:
        - name: &lt;crt-secret&gt; <b class="conum">(2)</b>
          key: postgres-crt.pem, postgres-ca.pem, postgres-key.key # key name as in &lt;crt-secret&gt; Secret
    extraEnvs:
      secrets:
        - name: &lt;cred-secret&gt; <b class="conum">(3)</b>
        # ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set the value of the <code>enableLocalDb</code> parameter to <code>false</code> to disable creating local PostgreSQL instances.</p>
</li>
<li>
<p>Provide the name of the certificate secret if you have configured a TLS connection.</p>
</li>
<li>
<p>Provide the name of the credential secret that you created.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The environment variables listed in the <code>Backstage</code> CR work with the Operator default configuration. If you have changed the Operator default configuration, you must reconfigure the <code>Backstage</code> CR accordingly.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the <code>Backstage</code> CR to the namespace where you have deployed the RHDH instance.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-configuring-postgresql-instance-using-helm_admin-rhdh">3.2. Configuring an external PostgreSQL instance using the Helm Chart</h3>
<div class="paragraph">
<p>You can configure an external PostgreSQL instance by using the Helm Chart. By default, the Helm Chart creates and manages a local instance of PostgreSQL in the same namespace where you have deployed the RHDH instance. However, you can change this default setting to configure an external PostgreSQL database server, for example, Amazon Web Services (AWS) Relational Database Service (RDS) or Azure database.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You are using a supported version of PostgreSQL. For more information, see the <a href="https://access.redhat.com/support/policy/updates/developerhub">Product life cycle page</a>.</p>
</li>
<li>
<p>You have the following details:</p>
<div class="ulist">
<ul>
<li>
<p><code>db-host</code>: Denotes your PostgreSQL instance Domain Name System (DNS) or IP address</p>
</li>
<li>
<p><code>db-port</code>: Denotes your PostgreSQL instance port number, such as <code>5432</code></p>
</li>
<li>
<p><code>username</code>: Denotes the user name to connect to your PostgreSQL instance</p>
</li>
<li>
<p><code>password</code>: Denotes the password to connect to your PostgreSQL instance</p>
</li>
</ul>
</div>
</li>
<li>
<p>You have installed the RHDH application by using the Helm Chart.</p>
</li>
<li>
<p>Optional: You have a CA certificate, Transport Layer Security (TLS) private key, and TLS certificate so that you can secure your database connection by using the TLS protocol. For more information, refer to your PostgreSQL vendor documentation.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, Developer Hub uses a database for each plugin and automatically creates it if none is found. You might need the <code>Create Database</code> privilege in addition to <code>PSQL Database</code> privileges for configuring an external PostgreSQL instance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Optional: Create a certificate secret to configure your PostgreSQL instance with a TLS connection:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;crt-secret&gt; <b class="conum">(1)</b>
type: Opaque
stringData:
 postgres-ca.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;ca-certificate-key&gt; <b class="conum">(2)</b>
 postgres-key.key: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-private-key&gt; <b class="conum">(3)</b>
 postgres-crt.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-certificate-key&gt; <b class="conum">(4)</b>
  # ...
EOF</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Provide the name of the certificate secret.</p>
</li>
<li>
<p>Provide the CA certificate key.</p>
</li>
<li>
<p>Optional: Provide the TLS private key.</p>
</li>
<li>
<p>Optional: Provide the TLS certificate key.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a credential secret to connect with the PostgreSQL instance:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;cred-secret&gt; <b class="conum">(1)</b>
type: Opaque
stringData: <b class="conum">(2)</b>
 POSTGRES_PASSWORD: &lt;password&gt;
 POSTGRES_PORT: "&lt;db-port&gt;"
 POSTGRES_USER: &lt;username&gt;
 POSTGRES_HOST: &lt;db-host&gt;
 PGSSLMODE: &lt;ssl-mode&gt; # for TLS connection <b class="conum">(3)</b>
 NODE_EXTRA_CA_CERTS: &lt;abs-path-to-pem-file&gt; # for TLS connection, e.g. /opt/app-root/src/postgres-crt.pem <b class="conum">(4)</b>
EOF</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Provide the name of the credential secret.</p>
</li>
<li>
<p>Provide credential data to connect with your PostgreSQL instance.</p>
</li>
<li>
<p>Optional: Provide the value based on the required <a href="https://www.postgresql.org/docs/15/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">Secure Sockets Layer (SSL) mode</a>.</p>
</li>
<li>
<p>Optional: Provide the value only if you need a TLS connection for your PostgreSQL instance.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configure your PostgreSQL instance in the Helm configuration file named <code>values.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
upstream:
  postgresql:
    enabled: false  # disable PostgreSQL instance creation <b class="conum">(1)</b>
    auth:
      existingSecret: &lt;cred-secret&gt; # inject credentials secret to Backstage <b class="conum">(2)</b>
  backstage:
    appConfig:
      backend:
        database:
          connection:  # configure Backstage DB connection parameters
            host: ${POSTGRES_HOST}
            port: ${POSTGRES_PORT}
            user: ${POSTGRES_USER}
            password: ${POSTGRES_PASSWORD}
            ssl:
              rejectUnauthorized: true,
              ca:
                $file: /opt/app-root/src/postgres-ca.pem
              key:
                $file: /opt/app-root/src/postgres-key.key
              cert:
                $file: /opt/app-root/src/postgres-crt.pem
  extraEnvVarsSecrets:
    - &lt;cred-secret&gt; # inject credentials secret to Backstage <b class="conum">(3)</b>
  extraEnvVars:
    - name: BACKEND_SECRET
      valueFrom:
        secretKeyRef:
          key: backend-secret
          name: '{{ include "janus-idp.backend-secret-name" $ }}'
  extraVolumeMounts:
    - mountPath: /opt/app-root/src/dynamic-plugins-root
      name: dynamic-plugins-root
    - mountPath: /opt/app-root/src/postgres-crt.pem
      name: postgres-crt # inject TLS certificate to Backstage cont. <b class="conum">(4)</b>
      subPath: postgres-crt.pem
    - mountPath: /opt/app-root/src/postgres-ca.pem
      name: postgres-ca # inject CA certificate to Backstage cont. <b class="conum">(5)</b>
      subPath: postgres-ca.pem
    - mountPath: /opt/app-root/src/postgres-key.key
      name: postgres-key # inject TLS private key to Backstage cont. <b class="conum">(6)</b>
      subPath: postgres-key.key
  extraVolumes:
    - ephemeral:
        volumeClaimTemplate:
          spec:
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 1Gi
      name: dynamic-plugins-root
    - configMap:
        defaultMode: 420
        name: dynamic-plugins
        optional: true
      name: dynamic-plugins
    - name: dynamic-plugins-npmrc
      secret:
        defaultMode: 420
        optional: true
        secretName: dynamic-plugins-npmrc
    - name: postgres-crt
      secret:
        secretName: &lt;crt-secret&gt; <b class="conum">(7)</b>
        # ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set the value of the <code>upstream.postgresql.enabled</code> parameter to <code>false</code> to disable creating local PostgreSQL instances.</p>
</li>
<li>
<p>Provide the name of the credential secret.</p>
</li>
<li>
<p>Provide the name of the credential secret.</p>
</li>
<li>
<p>Optional: Provide the name of the TLS certificate only for a TLS connection.</p>
</li>
<li>
<p>Optional: Provide the name of the CA certificate only for a TLS connection.</p>
</li>
<li>
<p>Optional: Provide the name of the TLS private key only if your TLS connection requires a private key.</p>
</li>
<li>
<p>Provide the name of the certificate secret if you have configured a TLS connection.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the configuration changes in your Helm configuration file named <code>values.yaml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>helm upgrade -n &lt;your-namespace&gt; &lt;your-deploy-name&gt; openshift-helm-charts/redhat-developer-hub -f values.yaml --version 1.3.0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-migrating-databases-to-an-external-server_admin-rhdh">3.3. Migrating local databases to an external database server using the Operator</h3>
<div class="paragraph">
<p>By default, Red Hat Developer Hub hosts the data for each plugin in a PostgreSQL database. When you fetch the list of databases, you might see multiple databases based on the number of plugins configured in Developer Hub. You can migrate the data from an RHDH instance hosted on a local PostgreSQL server to an external PostgreSQL service, such as AWS RDS, Azure database, or Crunchy database. To migrate the data from each RHDH instance, you can use PostgreSQL utilities, such as <a href="https://www.postgresql.org/docs/current/app-pgdump.html"><code>pg_dump</code></a> with <a href="https://www.postgresql.org/docs/current/app-psql.html"><code>psql</code></a> or <a href="https://www.pgadmin.org/"><code>pgAdmin</code></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The following procedure uses a database copy script to do a quick migration.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the <a href="https://www.postgresql.org/docs/current/app-pgdump.html"><code>pg_dump</code></a> and <a href="https://www.postgresql.org/docs/current/app-psql.html"><code>psql</code></a> utilities on your local machine.</p>
</li>
<li>
<p>For data export, you have the PGSQL user privileges to make a full dump of local databases.</p>
</li>
<li>
<p>For data import, you have the PGSQL admin privileges to create an external database and populate it with database dumps.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Configure port forwarding for the local PostgreSQL database pod by running the following command on a terminal:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">oc port-forward -n &lt;your-namespace&gt; &lt;pgsql-pod-name&gt; &lt;forward-to-port&gt;:&lt;forward-from-port&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>&lt;pgsql-pod-name&gt;</code> variable denotes the name of a PostgreSQL pod with the format <code>backstage-psql-&lt;deployment-name&gt;-&lt;_index&gt;</code>.</p>
</li>
<li>
<p>The <code>&lt;forward-to-port&gt;</code> variable denotes the port of your choice to forward PostgreSQL data to.</p>
</li>
<li>
<p>The <code>&lt;forward-from-port&gt;</code> variable denotes the local PostgreSQL instance port, such as <code>5432</code>.</p>
<div class="listingblock">
<div class="title">Example: Configuring port forwarding</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">oc port-forward -n developer-hub backstage-psql-developer-hub-0 15432:5432</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Make a copy of the following <code>db_copy.sh</code> script and edit the details based on your configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="script">#!/bin/bash

to_host=&lt;db-service-host&gt; <b class="conum">(1)</b>
to_port=5432 <b class="conum">(2)</b>
to_user=postgres <b class="conum">(3)</b>

from_host=127.0.0.1 <b class="conum">(4)</b>
from_port=15432 <b class="conum">(5)</b>
from_user=postgres <b class="conum">(6)</b>

allDB=("backstage_plugin_app" "backstage_plugin_auth" "backstage_plugin_catalog" "backstage_plugin_permission" "backstage_plugin_scaffolder" "backstage_plugin_search") <b class="conum">(7)</b>

for db in ${!allDB[@]};
do
  db=${allDB[$db]}
  echo Copying database: $db
  PGPASSWORD=$TO_PSW psql -h $to_host -p $to_port -U $to_user -c "create database $db;"
  pg_dump -h $from_host -p $from_port -U $from_user -d $db | PGPASSWORD=$TO_PSW psql -h $to_host -p $to_port -U $to_user -d $db
done</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The destination host name, for example, <code>&lt;db-instance-name&gt;.rds.amazonaws.com</code>.</p>
</li>
<li>
<p>The destination port, such as <code>5432</code>.</p>
</li>
<li>
<p>The destination server username, for example, <code>postgres</code>.</p>
</li>
<li>
<p>The source host name, such as <code>127.0.0.1</code>.</p>
</li>
<li>
<p>The source port number, such as the <code>&lt;forward-to-port&gt;</code> variable.</p>
</li>
<li>
<p>The source server username, for example, <code>postgres</code>.</p>
</li>
<li>
<p>The name of databases to import in double quotes separated by spaces, for example, <code>("backstage_plugin_app" "backstage_plugin_auth" "backstage_plugin_catalog" "backstage_plugin_permission" "backstage_plugin_scaffolder" "backstage_plugin_search")</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a destination database for copying the data:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">/bin/bash TO_PSW=&lt;destination-db-password&gt; /path/to/db_copy.sh <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>&lt;destination-db-password&gt;</code> variable denotes the password to connect to the destination database.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can stop port forwarding when the copying of the data is complete. For more information about handling large databases and using the compression tools, see the <a href="https://www.postgresql.org/docs/current/backup-dump.html#BACKUP-DUMP-LARGE">Handling Large Databases</a> section on the PostgreSQL website.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Reconfigure your <code>Backstage</code> custom resource (CR). For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/administration_guide_for_red_hat_developer_hub/index#proc-configuring-postgresql-instance-using-operator_admin-rhdh">Configuring an external PostgreSQL instance using the Operator</a>.</p>
</li>
<li>
<p>Check that the following code is present at the end of your <code>Backstage</code> CR after reconfiguration:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
spec:
  database:
    enableLocalDb: false
  application:
  # ...
    extraFiles:
      secrets:
        - name: &lt;crt-secret&gt;
          key: postgres-crt.pem # key name as in &lt;crt-secret&gt; Secret
    extraEnvs:
      secrets:
        - name: &lt;cred-secret&gt;
# ...</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Reconfiguring the <code>Backstage</code> CR deletes the corresponding <code>StatefulSet</code> and <code>Pod</code> objects, but does not delete the <code>PersistenceVolumeClaim</code> object. Use the following command to delete the local <code>PersistenceVolumeClaim</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">oc -n developer-hub delete pvc &lt;local-psql-pvc-name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where, the <code>&lt;local-psql-pvc-name&gt;</code> variable is in the <code>data-&lt;psql-pod-name&gt;</code> format.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Apply the configuration changes.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Verify that your RHDH instance is running with the migrated data and does not contain the local PostgreSQL database by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">oc get pods -n &lt;your-namespace&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Check the output for the following details:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>backstage-developer-hub-xxx</code> pod is in running state.</p>
</li>
<li>
<p>The <code>backstage-psql-developer-hub-0</code> pod is not available.</p>
<div class="paragraph">
<p>You can also verify these details using the <strong>Topology</strong> view in the OpenShift Container Platform web console.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proc-configuring-an-rhdh-instance-with-tls-in-kubernetes_admin-rhdh">Chapter 4. Configuring an RHDH instance with a TLS connection in Kubernetes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure an RHDH instance with a Transport Layer Security (TLS) connection in a Kubernetes cluster, such as an Azure Red Hat OpenShift (ARO) cluster, any cluster from a supported cloud provider, or your own cluster with proper configuration. However, You must use a public Certificate Authority (CA)-signed certificate to configure your Kubernetes cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have set up an Azure Red Hat OpenShift (ARO) cluster with a public CA-signed certificate. For more information about obtaining CA certificates, refer to your vendor documentation.</p>
</li>
<li>
<p>You have created a namespace and setup a service account with proper read permissions on resources.</p>
<div class="listingblock">
<div class="title">Example: Kubernetes manifest for role-based access control</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: backstage-read-only
rules:
  - apiGroups:
      - '*'
    resources:
      - pods
      - configmaps
      - services
      - deployments
      - replicasets
      - horizontalpodautoscalers
      - ingresses
      - statefulsets
      - limitranges
      - resourcequotas
      - daemonsets
    verbs:
      - get
      - list
      - watch
#...</code></pre>
</div>
</div>
</li>
<li>
<p>You have obtained the secret and the service CA certificate associated with your service account.</p>
</li>
<li>
<p>You have created some resources and added annotations to them so they can be discovered by the Kubernetes plugin. You can apply these Kubernetes annotations:</p>
<div class="ulist">
<ul>
<li>
<p><code>backstage.io/kubernetes-id</code> to label components</p>
</li>
<li>
<p><code>backstage.io/kubernetes-namespace</code> to label namespaces</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable the Kubernetes plugins in the <code>dynamic-plugins-rhdh.yaml</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes-backend-dynamic
        disabled: false <b class="conum">(1)</b>
      - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes
        disabled: false <b class="conum">(2)</b>
        # ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Set the value to <code>false</code> to enable the <code>backstage-plugin-kubernetes-backend-dynamic</code> plugin.</p>
</li>
<li>
<p>Set the value to <code>false</code> to enable the <code>backstage-plugin-kubernetes</code> plugin.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>backstage-plugin-kubernetes</code> plugin is currently in <a href="https://access.redhat.com/support/offerings/techpreview">Technology Preview</a>. As an alternative, you can use the <code>./dynamic-plugins/dist/backstage-plugin-topology-dynamic</code> plugin, which is Generally Available (GA).</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Set the kubernetes cluster details and configure the catalog sync options in the <code>app-config-rhdh.yaml</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  "app-config-rhdh.yaml": |
  # ...
  catalog:
    rules:
      - allow: [Component, System, API, Resource, Location]
    providers:
      kubernetes:
        openshift:
          cluster: openshift
          processor:
            namespaceOverride: default
            defaultOwner: guests
          schedule:
            frequency:
              seconds: 30
            timeout:
              seconds: 5
  kubernetes:
    serviceLocatorMethod:
      type: 'multiTenant'
    clusterLocatorMethods:
      - type: 'config'
        clusters:
          - url: &lt;target-cluster-api-server-url&gt; <b class="conum">(1)</b>
            name: openshift
            authProvider: 'serviceAccount'
            skipTLSVerify: false <b class="conum">(2)</b>
            skipMetricsLookup: true
            dashboardUrl: &lt;target-cluster-console-url&gt; <b class="conum">(3)</b>
            dashboardApp: openshift
            serviceAccountToken: ${K8S_SERVICE_ACCOUNT_TOKEN} <b class="conum">(4)</b>
            caData: ${K8S_CONFIG_CA_DATA} <b class="conum">(5)</b>
            # ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The base URL to the Kubernetes control plane. You can run the <code>kubectl cluster-info</code> command to get the base URL.</p>
</li>
<li>
<p>Set the value of this parameter to <code>false</code> to enable the verification of the TLS certificate.</p>
</li>
<li>
<p>Optional: The link to the Kubernetes dashboard managing the ARO cluster.</p>
</li>
<li>
<p>Optional: Pass the service account token using a <code>K8S_SERVICE_ACCOUNT_TOKEN</code> environment variable that you can define in your <code>secrets-rhdh</code> secret.</p>
</li>
<li>
<p>Pass the CA data using a <code>K8S_CONFIG_CA_DATA</code> environment variable that you can define in your <code>secrets-rhdh</code> secret.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Run the RHDH application to import your catalog:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">kubectl -n rhdh-operator get pods -w</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the pod log shows no errors for your configuration.</p>
</li>
<li>
<p>Go to <strong>Catalog</strong> and check the component page in the Developer Hub instance to verify the cluster connection and the presence of your created resources.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you encounter connection errors, such as certificate issues or permissions, check the message box in the component page or view the logs of the pod.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-rhdh-telemetry">Chapter 5. Telemetry data collection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The telemetry data collection feature helps in collecting and analyzing the telemetry data to improve your experience with Red Hat Developer Hub. This feature is enabled by default.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>As an administrator, you can disable the telemetry data collection feature based on your needs. For example, in an air-gapped environment, you can disable this feature to avoid needless outbound requests affecting the responsiveness of the RHDH application. For more details, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/administration_guide_for_red_hat_developer_hub/index#disabling-telemetry-data-collection_admin-rhdh">Disabling telemetry data collection in RHDH</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Red Hat collects and analyzes the following data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Events of page visits and clicks on links or buttons.</p>
</li>
<li>
<p>System-related information, for example, locale, timezone, user agent including browser and OS details.</p>
</li>
<li>
<p>Page-related information, for example, title, category, extension name, URL, path, referrer, and search parameters.</p>
</li>
<li>
<p>Anonymized IP addresses, recorded as <code>0.0.0.0</code>.</p>
</li>
<li>
<p>Anonymized username hashes, which are unique identifiers used solely to identify the number of unique users of the RHDH application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With RHDH, you can customize the telemetry data collection feature and the telemetry Segment source configuration based on your needs.</p>
</div>
<div class="sect2">
<h3 id="disabling-telemetry-data-collection_admin-rhdh">5.1. Disabling telemetry data collection in RHDH</h3>
<div class="paragraph">
<p>To disable telemetry data collection, you must disable the <code>analytics-provider-segment</code> plugin either using the Helm Chart or the Red Hat Developer Hub Operator configuration.</p>
</div>
<div class="sect3">
<h4 id="proc-disabling-telemetry-using-helm_admin-rhdh">5.1.1. Disabling telemetry data collection using the Helm Chart</h4>
<div class="paragraph">
<p>You can disable the telemetry data collection feature by using the Helm Chart.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm Chart.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <strong>Developer</strong> perspective of the OpenShift Container Platform web console, go to the <strong>Helm</strong> view to see the list of Helm releases.</p>
</li>
<li>
<p>Click the <strong>overflow</strong> menu on the Helm release that you want to use and select <strong>Upgrade</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can also create a new Helm release by clicking the <strong>Create</strong> button and edit the configuration to disable telemetry.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use either the <strong>Form</strong> view or <strong>YAML</strong> view to edit the Helm configuration:</p>
<div class="ulist">
<ul>
<li>
<p>Using <strong>Form view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Expand <strong>Root Schema → global → Dynamic plugins configuration. → List of dynamic plugins that should be installed in the backstage application</strong>.</p>
</li>
<li>
<p>Click the <strong>Add list of dynamic plugins that should be installed in the backstage application.</strong> link.</p>
</li>
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have not configured the plugin, add the following value in the <strong>Package specification of the dynamic plugin to install. It should be usable by the npm pack command.</strong> field:</p>
<div class="paragraph">
<p><code>./dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/disabling-telemetry.png" alt="disabling telemetry">
</div>
</div>
</li>
<li>
<p>If you have configured the plugin, find the <strong>Package specification of the dynamic plugin to install. It should be usable by the npm pack command.</strong> field with the <code>./dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment</code> value.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Select the <strong>Disable the plugin</strong> checkbox.</p>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using <strong>YAML view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have not configured the plugin, add the following YAML code in your <code>values.yaml</code> Helm configuration file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
global:
  dynamic:
    plugins:
      - package: './dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment'
        disabled: true
# ...</code></pre>
</div>
</div>
</li>
<li>
<p>If you have configured the plugin, search it in your Helm configuration and set the value of the <code>plugins.disabled</code> parameter to <code>true</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-disabling-telemetry-using-operator_admin-rhdh">5.1.2. Disabling telemetry data collection using the Operator</h4>
<div class="paragraph">
<p>You can disable the telemetry data collection feature by using the Operator.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Operator.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have created the <code>dynamic-plugins-rhdh</code> ConfigMap file and not configured the <code>analytics-provider-segment</code> plugin, add the plugin to the list of plugins and set its <code>plugins.disabled</code> parameter to <code>true</code>.</p>
</li>
<li>
<p>If you have created the <code>dynamic-plugins-rhdh</code> ConfigMap file and configured the <code>analytics-provider-segment</code> plugin, search the plugin in the list of plugins and set its <code>plugins.disabled</code> parameter to <code>true</code>.</p>
</li>
<li>
<p>If you have not created the ConfigMap file, create it with the following YAML code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - package: './dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment'
        disabled: true</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Set the value of the <code>dynamicPluginsConfigMapName</code> parameter to the name of the ConfigMap file in your <code>Backstage</code> custom resource:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
spec:
  application:
    dynamicPluginsConfigMapName: dynamic-plugins-rhdh
# ...</code></pre>
</div>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enabling-telemetry-data-collection_admin-rhdh">5.2. Enabling telemetry data collection in RHDH</h3>
<div class="paragraph">
<p>The telemetry data collection feature is enabled by default. However, if you have disabled the feature and want to re-enable it, you must enable the <code>analytics-provider-segment</code> plugin either by using the Helm Chart or the Red Hat Developer Hub Operator configuration.</p>
</div>
<div class="sect3">
<h4 id="proc-enabling-telemetry-using-helm_admin-rhdh">5.2.1. Enabling telemetry data collection using the Helm Chart</h4>
<div class="paragraph">
<p>You can enable the telemetry data collection feature by using the Helm Chart.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm Chart.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <strong>Developer</strong> perspective of the OpenShift Container Platform web console, go to the <strong>Helm</strong> view to see the list of Helm releases.</p>
</li>
<li>
<p>Click the <strong>overflow</strong> menu on the Helm release that you want to use and select <strong>Upgrade</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can also create a new Helm release by clicking the <strong>Create</strong> button and edit the configuration to enable telemetry.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use either the <strong>Form</strong> view or <strong>YAML</strong> view to edit the Helm configuration:</p>
<div class="ulist">
<ul>
<li>
<p>Using <strong>Form view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Expand <strong>Root Schema → global → Dynamic plugins configuration. → List of dynamic plugins that should be installed in the backstage application</strong>.</p>
</li>
<li>
<p>Click the <strong>Add list of dynamic plugins that should be installed in the backstage application.</strong> link.</p>
</li>
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have not configured the plugin, add the following value in the <strong>Package specification of the dynamic plugin to install. It should be usable by the npm pack command.</strong> field:</p>
<div class="paragraph">
<p><code>./dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment</code></p>
</div>
</li>
<li>
<p>If you have configured the plugin, find the <strong>Package specification of the dynamic plugin to install. It should be usable by the npm pack command.</strong> field with the <code>./dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment</code> value.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Clear the <strong>Disable the plugin</strong> checkbox.</p>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using <strong>YAML view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have not configured the plugin, add the following YAML code in your Helm configuration file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
global:
  dynamic:
    plugins:
      - package: './dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment'
        disabled: false
# ...</code></pre>
</div>
</div>
</li>
<li>
<p>If you have configured the plugin, search it in your Helm configuration and set the value of the <code>plugins.disabled</code> parameter to <code>false</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-enabling-telemetry-using-operator_admin-rhdh">5.2.2. Enabling telemetry data collection using the Operator</h4>
<div class="paragraph">
<p>You can enable the telemetry data collection feature by using the Operator.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Operator.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Perform one of the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>If you have created the <code>dynamic-plugins-rhdh</code> ConfigMap file and not configured the <code>analytics-provider-segment</code> plugin, add the plugin to the list of plugins and set its <code>plugins.disabled</code> parameter to <code>false</code>.</p>
</li>
<li>
<p>If you have created the <code>dynamic-plugins-rhdh</code> ConfigMap file and configured the <code>analytics-provider-segment</code> plugin, search the plugin in the list of plugins and set its <code>plugins.disabled</code> parameter to <code>false</code>.</p>
</li>
<li>
<p>If you have not created the ConfigMap file, create it with the following YAML code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - package: './dynamic-plugins/dist/janus-idp-backstage-plugin-analytics-provider-segment'
        disabled: false</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Set the value of the <code>dynamicPluginsConfigMapName</code> parameter to the name of the ConfigMap file in your <code>Backstage</code> custom resource:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
spec:
  application:
    dynamicPluginsConfigMapName: dynamic-plugins-rhdh
# ...</code></pre>
</div>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing-telemetry-segment_admin-rhdh">5.3. Customizing telemetry Segment source</h3>
<div class="paragraph">
<p>The <code>analytics-provider-segment</code> plugin sends the collected telemetry data to Red Hat by default. However, you can configure a new Segment source that receives telemetry data based on your needs. For configuration, you need a unique Segment write key that points to the Segment source.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By configuring a new Segment source, you can collect and analyze the same set of data that is mentioned in the <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/administration_guide_for_red_hat_developer_hub/index#assembly-rhdh-telemetry">Telemetry data collection</a> section. You might also require to create your own telemetry data collection notice for your application users.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="proc-customizing-telemetry-segment-using-helm_admin-rhdh">5.3.1. Customizing telemetry Segment source using the Helm Chart</h4>
<div class="paragraph">
<p>You can configure integration with your Segment source by using the Helm Chart.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm Chart.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <strong>Developer</strong> perspective of the OpenShift Container Platform web console, go to the <strong>Helm</strong> view to see the list of Helm releases.</p>
</li>
<li>
<p>Click the <strong>overflow</strong> menu on the Helm release that you want to use and select <strong>Upgrade</strong>.</p>
</li>
<li>
<p>Use either the <strong>Form</strong> view or <strong>YAML</strong> view to edit the Helm configuration:</p>
<div class="ulist">
<ul>
<li>
<p>Using <strong>Form view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Expand <strong>Root Schema → Backstage Chart Schema → Backstage Parameters → Backstage container environment variables</strong>.</p>
</li>
<li>
<p>Click the <strong>Add Backstage container environment variables</strong> link.</p>
</li>
<li>
<p>Enter the name and value of the Segment key.</p>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/segment-source-helm.png" alt="segment source helm">
</div>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Using <strong>YAML view</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add the following YAML code in your Helm configuration file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
upstream:
  backstage:
    extraEnvVars:
      - name: SEGMENT_WRITE_KEY
        value: &lt;segment_key&gt; # <b class="conum">(1)</b>
# ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Replace <code>&lt;segment_key&gt;</code> with a unique identifier for your Segment source.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-customizing-telemetry-segment-using-operator_admin-rhdh">5.3.2. Customizing telemetry Segment source using the Operator</h4>
<div class="paragraph">
<p>You can configure integration with your Segment source by using the Operator.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have logged in as an administrator in the OpenShift Container Platform web console.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Operator.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following YAML code in your <code>Backstage</code> custom resource (CR):</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
spec:
  application:
    extraEnvs:
      envs:
        - name: SEGMENT_WRITE_KEY
          value: &lt;segment_key&gt; # <b class="conum">(1)</b>
# ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Replace <code>&lt;segment_key&gt;</code> with a unique identifier for your Segment source.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-rhdh-observability">Chapter 6. Enabling observability for Red Hat Developer Hub on OpenShift Container Platform</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>In OpenShift Container Platform, metrics are exposed through an HTTP service endpoint under the <code>/metrics</code> canonical name. You can create a <code>ServiceMonitor</code> custom resource (CR) to scrape metrics from a service endpoint in a user-defined project.</p>
</div>
<div class="sect2">
<h3 id="proc-admin-enabling-metrics-ocp-helm_assembly-rhdh-observability">6.1. Enabling metrics monitoring in a Helm chart installation on an OpenShift Container Platform cluster</h3>
<div class="paragraph">
<p>You can enable and view metrics for a Red Hat Developer Hub Helm deployment from the <strong>Developer</strong> perspective of the OpenShift Container Platform web console.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your OpenShift Container Platform cluster has <a href="https://docs.openshift.com/container-platform/latest/observability/monitoring/enabling-monitoring-for-user-defined-projects.html">monitoring for user-defined projects</a> enabled.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm chart.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>From the <strong>Developer</strong> perspective in the OpenShift Container Platform web console, select the <strong>Topology</strong> view.</p>
</li>
<li>
<p>Click the overflow menu of the Red Hat Developer Hub Helm chart, and select <strong>Upgrade</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/helm-upgrade.png" alt="helm upgrade">
</div>
</div>
</li>
<li>
<p>On the <strong>Upgrade Helm Release</strong> page, select the <strong>YAML view</strong> option in <strong>Configure via</strong>, then configure the <code>metrics</code> section in the YAML, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">upstream:
# ...
  metrics:
    serviceMonitor:
      enabled: true
      path: /metrics
# ...</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/upgrade-helm-metrics.png" alt="upgrade helm metrics">
</div>
</div>
</li>
<li>
<p>Click <strong>Upgrade</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>From the <strong>Developer</strong> perspective in the OpenShift Container Platform web console, select the <strong>Observe</strong> view.</p>
</li>
<li>
<p>Click the <strong>Metrics</strong> tab to view metrics for Red Hat Developer Hub pods.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-admin-enabling-metrics-ocp-operator_assembly-rhdh-observability">6.2. Enabling metrics monitoring in a Red Hat Developer Hub Operator installation on an OpenShift Container Platform cluster</h3>
<div class="paragraph">
<p>You can enable and view metrics for an Operator-installed Red Hat Developer Hub instance from the <strong>Developer</strong> perspective of the OpenShift Container Platform web console.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your OpenShift Container Platform cluster has <a href="https://docs.openshift.com/container-platform/latest/observability/monitoring/enabling-monitoring-for-user-defined-projects.html">monitoring for user-defined projects</a> enabled.</p>
</li>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Red Hat Developer Hub Operator.</p>
</li>
<li>
<p>You have installed the OpenShift CLI (<code>oc</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Currently, the Red Hat Developer Hub Operator does not support creating a <code>ServiceMonitor</code> custom resource (CR) by default. You must complete the following steps to create a <code>ServiceMonitor</code> CR to scrape metrics from the endpoint.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the <code>ServiceMonitor</code> CR as a YAML file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: &lt;custom_resource_name&gt; # <b class="conum">(1)</b>
  namespace: &lt;project_name&gt; # <b class="conum">(2)</b>
  labels:
    app.kubernetes.io/instance: &lt;custom_resource_name&gt;
    app.kubernetes.io/name: backstage
spec:
  namespaceSelector:
    matchNames:
      - &lt;project_name&gt;
  selector:
    matchLabels:
      rhdh.redhat.com/app: backstage-&lt;custom_resource_name&gt;
  endpoints:
  - port: backend
    path: '/metrics'</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Replace <code>&lt;custom_resource_name&gt;</code> with the name of your Red Hat Developer Hub CR.</p>
</li>
<li>
<p>Replace <code>&lt;project_name&gt;</code> with the name of the OpenShift Container Platform project where your Red Hat Developer Hub instance is running.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the <code>ServiceMonitor</code> CR by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">oc apply -f &lt;filename&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>From the <strong>Developer</strong> perspective in the OpenShift Container Platform web console, select the <strong>Observe</strong> view.</p>
</li>
<li>
<p>Click the <strong>Metrics</strong> tab to view metrics for Red Hat Developer Hub pods.</p>
</li>
</ol>
</div>
</div>
<div class="sect2 _additional-resources">
<h3 id="additional-resources_assembly-rhdh-observability">6.3. Additional resources</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/observability/monitoring/managing-metrics.html">OpenShift Container Platform - Managing metrics</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-running-rhdh-behind-a-proxy">Chapter 7. Running the RHDH application behind a corporate proxy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can run the RHDH application behind a corporate proxy by setting any of the following environment variables before starting the application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HTTP_PROXY</code>: Denotes the proxy to use for HTTP requests.</p>
</li>
<li>
<p><code>HTTPS_PROXY</code>: Denotes the proxy to use for HTTPS requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, you can set the <code>NO_PROXY</code> environment variable to exclude certain domains from proxying. The variable value is a comma-separated list of hostnames that do not require a proxy to get reached, even if one is specified.</p>
</div>
<div class="sect2">
<h3 id="proc-configuring-proxy-in-helm-deployment_assembly-rhdh-observability">7.1. Configuring proxy information in Helm deployment</h3>
<div class="paragraph">
<p>For Helm-based deployment, either a developer or a cluster administrator with permissions to create resources in the cluster can configure the proxy variables in a <code>values.yaml</code> Helm configuration file.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Red Hat Developer Hub application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Set the proxy information in your Helm configuration file:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">upstream:
  backstage:
    extraEnvVars:
      - name: HTTP_PROXY
        value: '&lt;http_proxy_url&gt;'
      - name: HTTPS_PROXY
        value: '&lt;https_proxy_url&gt;'
      - name: NO_PROXY
        value: '&lt;no_proxy_settings&gt;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where,</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>&lt;http_proxy_url&gt;</code></dt>
<dd>
<p>Denotes a variable that you must replace with the HTTP proxy URL.</p>
</dd>
<dt class="hdlist1"><code>&lt;https_proxy_url&gt;</code></dt>
<dd>
<p>Denotes a variable that you must replace with the HTTPS proxy URL.</p>
</dd>
<dt class="hdlist1"><code>&lt;no_proxy_settings&gt;</code></dt>
<dd>
<p>Denotes a variable that you must replace with comma-separated URLs, which you want to exclude from proxying, for example, <code>foo.com,baz.com</code>.</p>
<div class="listingblock">
<div class="title">Example: Setting proxy variables using Helm Chart</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">upstream:
  backstage:
    extraEnvVars:
      - name: HTTP_PROXY
        value: 'http://10.10.10.105:3128'
      - name: HTTPS_PROXY
        value: 'http://10.10.10.106:3128'
      - name: NO_PROXY
        value: 'localhost,example.org'</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-configuring-proxy-in-operator-deployment_assembly-rhdh-observability">7.2. Configuring proxy information in Operator deployment</h3>
<div class="paragraph">
<p>For Operator-based deployment, the approach you use for proxy configuration is based on your role:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>As a cluster administrator with access to the Operator namespace, you can configure the proxy variables in the Operator&#8217;s default ConfigMap file. This configuration applies the proxy settings to all the users of the Operator.</p>
</li>
<li>
<p>As a developer, you can configure the proxy variables in a custom resource (CR) file. This configuration applies the proxy settings to the RHDH application created from that CR.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Red Hat Developer Hub application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Perform one of the following steps based on your role:</p>
<div class="ulist">
<ul>
<li>
<p>As an administrator, set the proxy information in the Operator&#8217;s default ConfigMap file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Search for a ConfigMap file named <code>backstage-default-config</code> in the default namespace <code>rhdh-operator</code> and open it.</p>
</li>
<li>
<p>Find the <code>deployment.yaml</code> key.</p>
</li>
<li>
<p>Set the value of the <code>HTTP_PROXY</code>, <code>HTTPS_PROXY</code>, and <code>NO_PROXY</code> environment variables in the <code>Deployment</code> spec as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example: Setting proxy variables in a ConfigMap file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># Other fields omitted
  deployment.yaml: |-
    apiVersion: apps/v1
    kind: Deployment
    spec:
      template:
        spec:
          # Other fields omitted
          initContainers:
            - name: install-dynamic-plugins
              # command omitted
              env:
                - name: NPM_CONFIG_USERCONFIG
                  value: /opt/app-root/src/.npmrc.dynamic-plugins
                - name: HTTP_PROXY
                  value: 'http://10.10.10.105:3128'
                - name: HTTPS_PROXY
                  value: 'http://10.10.10.106:3128'
                - name: NO_PROXY
                  value: 'localhost,example.org'
              # Other fields omitted
          containers:
            - name: backstage-backend
              # Other fields omitted
              env:
                - name: APP_CONFIG_backend_listen_port
                  value: "7007"
                - name: HTTP_PROXY
                  value: 'http://10.10.10.105:3128'
                - name: HTTPS_PROXY
                  value: 'http://10.10.10.106:3128'
                - name: NO_PROXY
                  value: 'localhost,example.org'</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>As a developer, set the proxy information in your custom resource (CR) file as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example: Setting proxy variables in a CR file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">spec:
  # Other fields omitted
  application:
    extraEnvs:
      envs:
        - name: HTTP_PROXY
          value: 'http://10.10.10.105:3128'
        - name: HTTPS_PROXY
          value: 'http://10.10.10.106:3128'
        - name: NO_PROXY
          value: 'localhost,example.org'</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Save the configuration changes.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="con-rbac-overview_assembly-rhdh-observability">Chapter 8. Role-Based Access Control (RBAC) in Red Hat Developer Hub</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Role-Based Access Control is a security paradigm that restricts access to authorized users. This feature includes defining roles with specific permissions and then assigning those roles to the users.</p>
</div>
<div class="paragraph">
<p>The Red Hat Developer Hub uses RBAC to improve the permission system within the platform. The RBAC feature in Developer Hub introduces an administrator role and leverages the organizational structure including teams, groups, and users by facilitating efficient access control.</p>
</div>
<div class="sect2">
<h3 id="ref-rbac-permission-policies_assembly-rhdh-observability">8.1. Permission policies in Red Hat Developer Hub</h3>
<div class="paragraph">
<p>Permission policies in Red Hat Developer Hub are a set of rules to govern access to resources or functionalities. These policies state the authorization level that is granted to users based on their roles. The permission policies are implemented to maintain security and confidentiality within a given environment.</p>
</div>
<div class="paragraph">
<p>You can define the following types of permissions in Developer Hub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>resource type</p>
</li>
<li>
<p>basic</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The distinction between the two permission types depend on whether a permission includes a defined resource type.</p>
</div>
<div class="paragraph">
<p>You can define the resource type permission using either the associated resource type or the permission name as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example resource type permission definition</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">p, role:default/myrole, catalog.entity.read, read, allow
g, user:default/myuser, role:default/myrole

p, role:default/another-role, catalog-entity, read, allow
g, user:default/another-user, role:default/another-role</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define the basic permission in Developer Hub using the permission name as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example basic permission definition</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">p, role:default/myrole, catalog.entity.create, create, allow
g, user:default/myuser, role:default/myrole</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following permission policies are supported in the Developer Hub:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Catalog permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.entity.read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read from the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.entity.create</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to create catalog entities, including registering an existing component in the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.entity.refresh</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to refresh a single or multiple entities from the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.entity.delete</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to delete a single or multiple entities from the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.location.read</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read a single or multiple locations from the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.location.create</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to create locations within the catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>catalog.location.delete</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to delete locations from the catalog</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Scaffolder permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.action.execute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder-action</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the execution of an action from a template</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.template.parameter.read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder-template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read a single or multiple one parameters from a template</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.template.step.read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder-template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read a single or multiple steps from a template</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.task.create</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the user or role to trigger software templates which create new scaffolder tasks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.task.cancel</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the user or role to cancel currently running scaffolder tasks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scaffolder.task.read</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read all scaffolder tasks and their associated events and logs</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">RBAC permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy.entity.read</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read permission policies and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy.entity.create</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to create a single or multiple permission policies and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy.entity.update</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to update a single or multiple permission policies and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy.entity.delete</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to delete a single or multiple permission policies and roles</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Kubernetes permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes.proxy</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to access the proxy endpoint</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">OCM permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ocm.entity.read</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read from the OCM plugin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ocm.cluster.read</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to read the cluster information in the OCM plugin</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Topology permissions</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 25%;">
<col style="width: 15%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Resource type</th>
<th class="tableblock halign-left valign-top">Policy</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>topology.view.read</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to view the topology plugin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kubernetes.proxy</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows user or role to access the proxy endpoint, allowing them to read pod logs and events within RHDH</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="con-rbac-config-permission-policies_assembly-rhdh-observability">8.1.1. Permission policies configuration</h4>
<div class="paragraph">
<p>There are two approaches to configure the permission policies in Red Hat Developer Hub, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration of permission policies administrators</p>
</li>
<li>
<p>Configuration of permission policies defined in an external file</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="con-rbac-config-permission-policies-admin_assembly-rhdh-observability">Configuration of permission policies administrators</h5>
<div class="paragraph">
<p>The permission policies for users and groups in the Developer Hub are managed by permission policy administrators. Only permission policy administrators can access the Role-Based Access Control REST API.</p>
</div>
<div class="paragraph">
<p>The purpose of configuring policy administrators is to enable a specific, restricted number of authenticated users to access the RBAC REST API. The permission policies are defined in a <code>policy.csv</code> file, which is referenced in the <code>app-config-rhdh</code> ConfigMap. OpenShift platform administrators or cluster administrators can perform this task with access to the namespace where Red Hat Developer Hub is deployed.</p>
</div>
<div class="paragraph">
<p>You can set the credentials of a permission policy administrator in the <code>app-config.yaml</code> file as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">permission:
  enabled: true
  rbac:
    admin:
      users:
        - name: user:default/joeuser</code></pre>
</div>
</div>
<div class="paragraph">
<p>The permission policy role (<code>role:default/rbac_admin</code>) is a default role in Developer Hub and includes some permissions upon creation, such as creating, reading, updating, and deleting permission policies/roles, as well as reading from the catalog.</p>
</div>
<div class="paragraph">
<p>If the default permissions are not adequate for your requirements, you can define a new administrator role tailored to your requirements using relevant permission policies. Alternatively, you can use the optional <code>superUsers</code> configuration value, which grants unrestricted permissions across Developer Hub.</p>
</div>
<div class="paragraph">
<p>You can set the <code>superUsers</code> in the <code>app-config.yaml</code> file as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
permission:
  enabled: true
  rbac:
    admin:
      superUsers:
        - name: user:default/joeuser
        # ...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-rbac-config-permission-policies-external-file_assembly-rhdh-observability">Configuration of permission policies defined in an external file</h5>
<div class="paragraph">
<p>You can configure the permission policies before starting the Red Hat Developer Hub. If permission policies are defined in an external file, then you can import the same file in the Developer Hub. You must define the permission policies using the following Casbin rules format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="format">---
`p, &lt;ROLE&gt;, &lt;PERMISSION_NAME or PERMISSION_RESOURCE_TYPE&gt;, &lt;PERMISSION_POLICY_ACTION&gt;, &lt;ALLOW or DENY&gt;`
---</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define roles using the following Casbin rules format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="format">---
`g, &lt;USER or GROUP&gt;, &lt;ROLE&gt;`
---</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For information about the Casbin rules format, see <a href="https://casbin.org/docs/category/the-basics">Basics of Casbin rules</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following is an example of permission policies configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">---
`p, role:default/guests, catalog-entity, read, allow`</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>p, role:default/guests, catalog.entity.create, create, allow</code></p>
</div>
<div class="paragraph">
<p><code>g, user:default/&lt;USER_TO_ROLE&gt;, role:default/guests</code></p>
</div>
<div class="paragraph">
<p><code>g, group:default/&lt;GROUP_TO_ROLE&gt;, role:default/guests</code>
---</p>
</div>
<div class="paragraph">
<p>If a defined permission does not contain an action associated with it, then add <code>use</code> as a policy. See the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">---
`p, role:default/guests, kubernetes.proxy, use, allow`
---</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define the <code>policy.csv</code> file path in the <code>app-config.yaml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">permission:
  enabled: true
  rbac:
    policies-csv-file: /some/path/rbac-policy.csv</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use an optional configuration value that enables reloading the CSV file without restarting the Developer Hub instance.</p>
</div>
<div class="paragraph">
<p>Set the value of the <code>policyFileReload</code> option in the <code>app-config.yaml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
permission:
  enabled: true
  rbac:
    policies-csv-file: /some/path/rbac-policy.csv
    policyFileReload: true
    # ...</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_mounting-policy-csv-file-to-the-developer-hub-helm-chart">Mounting <code>policy.csv</code> file to the Developer Hub Helm chart</h6>
<div class="paragraph">
<p>When the Red Hat Developer Hub is deployed with the Helm chart, you must define the <code>policy.csv</code> file by mounting it to the Developer Hub Helm chart.</p>
</div>
<div class="paragraph">
<p>You can add your <code>policy.csv</code> file to the Developer Hub Helm Chart by creating a <code>configMap</code> and mounting it.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You are logged in to your OpenShift Container Platform account using the OpenShift Container Platform web console.</p>
</li>
<li>
<p>Red Hat Developer Hub is installed and deployed using Helm Chart.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In OpenShift Container Platform, create a ConfigMap to hold the policies as shown in the following example:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>ConfigMap</code></div>
<div class="content">
<pre class="CodeRay highlight"><code>kind: ConfigMap
apiVersion: v1
metadata:
  name: rbac-policy
  namespace: rhdh
data:
  rbac-policy.csv: |
    p, role:default/guests, catalog-entity, read, allow
    p, role:default/guests, catalog.entity.create, create, allow

    g, user:default/&lt;YOUR_USER&gt;, role:default/guests</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>In the Developer Hub Helm Chart, go to <strong>Root Schema &#8594; Backstage chart schema &#8594; Backstage parameters &#8594; Backstage container additional volume mounts</strong>.</p>
</li>
<li>
<p>Select <strong>Add Backstage container additional volume mounts</strong> and add the following values:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>mountPath</strong>: <code>opt/app-root/src/rbac</code></p>
</li>
<li>
<p><strong>Name</strong>: <code>rbac-policy</code></p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Add the RBAC policy to the <strong>Backstage container additional volumes</strong> in the Developer Hub Helm Chart:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>name</strong>: <code>rbac-policy</code></p>
</li>
<li>
<p><strong>configMap</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>defaultMode</strong>: <code>420</code></p>
</li>
<li>
<p><strong>name</strong>: <code>rbac-policy</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Update the policy path in the <code>app-config.yaml</code> file as follows:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>app-config.yaml</code> file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">permission:
  enabled: true
  rbac:
    policies-csv-file: ./rbac/rbac-policy.csv</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-rbac-conditional-policies-rhdh_assembly-rhdh-observability">8.2. Conditional policies in Red Hat Developer Hub</h3>
<div class="paragraph">
<p>The permission framework in Red Hat Developer Hub provides conditions, supported by the RBAC backend plugin (<code>backstage-plugin-rbac-backend</code>). The conditions work as content filters for the Developer Hub resources that are provided by the RBAC backend plugin.</p>
</div>
<div class="paragraph">
<p>The RBAC backend API stores conditions assigned to roles in the database. When you request to access the frontend resources, the RBAC backend API searches for the corresponding conditions and delegates them to the appropriate plugin using its plugin ID. If you are assigned to multiple roles with different conditions, then the RBAC backend merges the conditions using the <code>anyOf</code> criteria.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Conditional criteria</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A condition in Developer Hub is a simple condition with a rule and parameters. However, a condition can also contain a parameter or an array of parameters combined by conditional criteria. The supported conditional criteria includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>allOf</code>: Ensures that all conditions within the array must be true for the combined condition to be satisfied.</p>
</li>
<li>
<p><code>anyOf</code>: Ensures that at least one of the conditions within the array must be true for the combined condition to be satisfied.</p>
</li>
<li>
<p><code>not</code>: Ensures that the condition within it must not be true for the combined condition to be satisfied.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Conditional object</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The plugin specifies the parameters supported for conditions. You can access the conditional object schema from the RBAC API endpoint to understand how to construct a conditional JSON object, which is then used by the RBAC backend plugin API.</p>
</div>
<div class="paragraph">
<p>A conditional object contains the following parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Conditional object parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 45%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always has the value <code>CONDITIONAL</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roleEntityRef</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String entity reference to the RBAC role, such as <code>role:default/dev</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pluginId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponding plugin ID, such as <code>catalog</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permissionMapping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array permission actions, such as <code>['read', 'update', 'delete']</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resourceType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource type provided by the plugin, such as <code>catalog-entity</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conditions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Condition JSON with parameters or array parameters joined by criteria</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="ref-rbac-conditional-policy-definition_assembly-rhdh-observability">8.2.1. Conditional policies definition</h4>
<div class="paragraph">
<p>You can access API endpoints for conditional policies in Red Hat Developer Hub. For example, to retrieve the available conditional rules, which can help you define these policies, you can access the <code>GET [api/plugins/condition-rules]</code> endpoint.</p>
</div>
<div class="paragraph">
<p>The <code>api/plugins/condition-rules</code> returns the condition parameters schemas, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
   {
      "pluginId": "catalog",
      "rules": [
         {
            "name": "HAS_ANNOTATION",
            "description": "Allow entities with the specified annotation",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "annotation": {
                     "type": "string",
                     "description": "Name of the annotation to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the annotation to match on"
                  }
               },
               "required": [
                  "annotation"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_LABEL",
            "description": "Allow entities with the specified label",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "label": {
                     "type": "string",
                     "description": "Name of the label to match on"
                  }
               },
               "required": [
                  "label"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_METADATA",
            "description": "Allow entities with the specified metadata subfield",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "key": {
                     "type": "string",
                     "description": "Property within the entities metadata to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the given property to match on"
                  }
               },
               "required": [
                  "key"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_SPEC",
            "description": "Allow entities with the specified spec subfield",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "key": {
                     "type": "string",
                     "description": "Property within the entities spec to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the given property to match on"
                  }
               },
               "required": [
                  "key"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "IS_ENTITY_KIND",
            "description": "Allow entities matching a specified kind",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "kinds": {
                     "type": "array",
                     "items": {
                        "type": "string"
                     },
                     "description": "List of kinds to match at least one of"
                  }
               },
               "required": [
                  "kinds"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "IS_ENTITY_OWNER",
            "description": "Allow entities owned by a specified claim",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "claims": {
                     "type": "array",
                     "items": {
                        "type": "string"
                     },
                     "description": "List of claims to match at least one on within ownedBy"
                  }
               },
               "required": [
                  "claims"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         }
      ]
   }
   ... &lt;another plugin condition parameter schemas&gt;
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The RBAC backend API constructs a condition JSON object based on the previous condition schema.</p>
</div>
<div class="sect4">
<h5 id="_examples-of-conditional-policies">Examples of conditional policies</h5>
<div class="paragraph">
<p>In Red Hat Developer Hub, you can define conditional policies with or without criteria. You can use the following examples to define the conditions based on your use case:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">A condition without criteria</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Consider a condition without criteria displaying catalogs only if user is a member of the owner group. To add this condition, you can use the catalog plugin schema <code>IS_ENTITY_OWNER</code> as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example condition without criteria</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "rule": "IS_ENTITY_OWNER",
  "resourceType": "catalog-entity",
  "params": {
    "claims": ["group:default/team-a"]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example, the only conditional parameter used is <code>claims</code>, which contains a list of user or group entity references.</p>
</div>
<div class="paragraph">
<p>You can apply the previous example condition to the RBAC REST API by adding additional parameters as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/test",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["read"],
  "conditions": {
    "rule": "IS_ENTITY_OWNER",
    "resourceType": "catalog-entity",
    "params": {
      "claims": ["group:default/team-a"]
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">A condition with criteria</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Consider a condition with criteria, which displays catalogs only if user is a member of owner group OR displays list of all catalog user groups.</p>
</div>
<div class="paragraph">
<p>To add the criteria, you can add another rule as <code>IS_ENTITY_KIND</code> in the condition as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example condition with criteria</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "anyOf": [
    {
      "rule": "IS_ENTITY_OWNER",
      "resourceType": "catalog-entity",
      "params": {
        "claims": ["group:default/team-a"]
      }
    },
    {
      "rule": "IS_ENTITY_KIND",
      "resourceType": "catalog-entity",
      "params": {
        "kinds": ["Group"]
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Running conditions in parallel during creation is not supported. Therefore, consider defining nested conditional policies based on the available criteria.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example of nested conditions</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "anyOf": [
    {
      "rule": "IS_ENTITY_OWNER",
      "resourceType": "catalog-entity",
      "params": {
        "claims": ["group:default/team-a"]
      }
    },
    {
      "rule": "IS_ENTITY_KIND",
      "resourceType": "catalog-entity",
      "params": {
        "kinds": ["Group"]
      }
    }
  ],
  "not": {
    "rule": "IS_ENTITY_KIND",
    "resourceType": "catalog-entity",
    "params": { "kinds": ["Api"] }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can apply the previous example condition to the RBAC REST API by adding additional parameters as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/test",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["read"],
  "conditions": {
    "anyOf": [
      {
        "rule": "IS_ENTITY_OWNER",
        "resourceType": "catalog-entity",
        "params": {
          "claims": ["group:default/team-a"]
        }
      },
      {
        "rule": "IS_ENTITY_KIND",
        "resourceType": "catalog-entity",
        "params": {
          "kinds": ["Group"]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following examples can be used with Developer Hub plugins. These examples can help you determine how to define conditional policies:</p>
</div>
<div class="listingblock">
<div class="title">Conditional policy defined for Keycloak plugin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/developer",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["update", "delete"],
  "conditions": {
    "not": {
      "rule": "HAS_ANNOTATION",
      "resourceType": "catalog-entity",
      "params": { "annotation": "keycloak.org/realm", "value": "&lt;YOUR_REALM&gt;" }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous example of Keycloak plugin prevents users in the <code>role:default/developer</code> from updating or deleting users that are ingested into the catalog from the Keycloak plugin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In the previous example, the annotation <code>keycloak.org/realm</code> requires the value of <code>&lt;YOUR_REALM&gt;</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Conditional policy defined for Quay plugin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/developer",
  "pluginId": "scaffolder",
  "resourceType": "scaffolder-action",
  "permissionMapping": ["use"],
  "conditions": {
    "not": {
      "rule": "HAS_ACTION_ID",
      "resourceType": "scaffolder-action",
      "params": { "actionId": "quay:create-repository" }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous example of Quay plugin prevents the role <code>role:default/developer</code> from using the Quay scaffolder action. Note that <code>permissionMapping</code> contains <code>use</code>, signifying that <code>scaffolder-action</code> resource type permission does not have a permission policy.</p>
</div>
<div class="paragraph">
<p>For more information about permissions in Red Hat Developer Hub, see <a href="#ref-rbac-permission-policies_assembly-rhdh-observability">Permission policies in Red Hat Developer Hub</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-rbac-ui-manage-roles_assembly-rhdh-observability">8.3. Managing role-based access controls (RBAC) using the Red Hat Developer Hub Web UI</h3>
<div class="paragraph">
<p>Administrators can use the Developer Hub web interface (Web UI) to allocate specific roles and permissions to individual users or groups. Allocating roles ensures that access to resources and functionalities is regulated across the Developer Hub.</p>
</div>
<div class="paragraph">
<p>With the administrator role in Developer Hub, you can assign permissions to users and groups, which allow users or groups to view, create, modify, and delete the roles using the Developer Hub Web UI.</p>
</div>
<div class="paragraph">
<p>To access the RBAC features in the Web UI, you must install and configure the <code>@janus-idp/backstage-plugin-rbac</code> plugin as a dynamic plugin. For more information about installing a dynamic plugin, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.</p>
</div>
<div class="paragraph">
<p>After you install the <code>@janus-idp/backstage-plugin-rbac</code> plugin, the <strong>Administration</strong> option appears at the bottom of the sidebar. When you can click <strong>Administration</strong>, the RBAC tab appears by default, displaying all of the existing roles created in the Developer Hub. In the RBAC tab, you can also view the total number of users, groups, and the total number of permission policies associated with a role. You can also edit or delete a role using the <strong>Actions</strong> column.</p>
</div>
<div class="sect3">
<h4 id="proc-rbac-ui-create-role_assembly-rhdh-observability">8.3.1. Creating a role in the Red Hat Developer Hub Web UI</h4>
<div class="paragraph">
<p>You can create a role in the Red Hat Developer Hub using the Web UI.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an administrator role in the Developer Hub.</p>
</li>
<li>
<p>You have installed the <code>@janus-idp/backstage-plugin-rbac</code> plugin in Developer Hub. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.</p>
</li>
<li>
<p>You have configured the required permission policies. For more information, see <a href="#con-rbac-config-permission-policies_assembly-rhdh-observability">Permission policies configuration</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to <strong>Administration</strong> at the bottom of the sidebar in the Developer Hub.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <strong>RBAC</strong> tab appears, displaying all the created roles in the Developer Hub.</p>
</div>
</div>
</div>
</li>
<li>
<p>(Optional) Click any role to view the role information on the <strong>OVERVIEW</strong> page.</p>
</li>
<li>
<p>Click <strong>CREATE</strong> to create a role.</p>
</li>
<li>
<p>Enter the name and description of the role in the given fields and click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Add users and groups using the search field, and click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Select <strong>Plugin</strong> and <strong>Permission</strong> from the drop-downs in the <strong>Add permission policies</strong> section.</p>
</li>
<li>
<p>Select or clear the <strong>Policy</strong> that you want to set in the <strong>Add permission policies</strong> section, and click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Review the added information in the <strong>Review and create</strong> section.</p>
</li>
<li>
<p>Click <strong>CREATE</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Verification</div>
<p>The created role appears in the list available in the <strong>RBAC</strong> tab.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-rbac-ui-edit-role_assembly-rhdh-observability">8.3.2. Editing a role in the Red Hat Developer Hub Web UI</h4>
<div class="paragraph">
<p>You can edit a role in the Red Hat Developer Hub using the Web UI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The policies generated from a <code>policy.csv</code> or ConfigMap file cannot be edited or deleted using the Developer Hub Web UI.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an administrator role in the Developer Hub.</p>
</li>
<li>
<p>You have installed the <code>@janus-idp/backstage-plugin-rbac</code> plugin in Developer Hub. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.</p>
</li>
<li>
<p>You have configured the required permission policies. For more information, see <a href="#con-rbac-config-permission-policies_assembly-rhdh-observability">Permission policies configuration</a>.</p>
</li>
<li>
<p>The role that you want to edit is created in the Developer Hub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to <strong>Administration</strong> at the bottom of the sidebar in the Developer Hub.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <strong>RBAC</strong> tab appears, displaying all the created roles in the Developer Hub.</p>
</div>
</div>
</div>
</li>
<li>
<p>(Optional) Click any role to view the role information on the <strong>OVERVIEW</strong> page.</p>
</li>
<li>
<p>Select the edit icon for the role that you want to edit.</p>
</li>
<li>
<p>Edit the details of the role, such as name, description, users and groups, and permission policies, and click <strong>NEXT</strong>.</p>
</li>
<li>
<p>Review the edited details of the role and click <strong>SAVE</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After editing a role, you can view the edited details of a role on the <strong>OVERVIEW</strong> page of a role. You can also edit a role’s users and groups or permissions by using the edit icon on the respective cards on the <strong>OVERVIEW</strong> page.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-rbac-ui-delete-role_assembly-rhdh-observability">8.3.3. Deleting a role in the Red Hat Developer Hub Web UI</h4>
<div class="paragraph">
<p>You can delete a role in the Red Hat Developer Hub using the Web UI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The policies generated from a <code>policy.csv</code> or ConfigMap file cannot be edited or deleted using the Developer Hub Web UI.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have an administrator role in the Developer Hub.</p>
</li>
<li>
<p>You have installed the <code>@janus-idp/backstage-plugin-rbac</code> plugin in Developer Hub. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.</p>
</li>
<li>
<p>You have configured the required permission policies. For more information, see <a href="#con-rbac-config-permission-policies_assembly-rhdh-observability">Permission policies configuration</a>.</p>
</li>
<li>
<p>The role that you want to delete is created in the Developer Hub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to <strong>Administration</strong> at the bottom of the sidebar in the Developer Hub.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The <strong>RBAC</strong> tab appears, displaying all the created roles in the Developer Hub.</p>
</div>
</div>
</div>
</li>
<li>
<p>(Optional) Click any role to view the role information on the <strong>OVERVIEW</strong> page.</p>
</li>
<li>
<p>Select the delete icon from the <strong>Actions</strong> column for the role that you want to delete.</p>
<div class="paragraph">
<p><strong>Delete this role?</strong> pop-up appears on the screen.</p>
</div>
</li>
<li>
<p>Click <strong>DELETE</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-rbac-rest-api_assembly-rhdh-observability">8.4. Role-based Access Control (RBAC) REST API</h3>
<div class="paragraph">
<p>Red Hat Developer Hub provides RBAC REST API that you can use to manage the permissions and roles in the Developer Hub. This API supports you to facilitate and automate the maintenance of Developer Hub permission policies and roles.</p>
</div>
<div class="paragraph">
<p>Using the RBAC REST API, you can perform the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Retrieve information about all permission policies or specific permission policies, or roles</p>
</li>
<li>
<p>Create, update, or delete a permission policy or a role</p>
</li>
<li>
<p>Retrieve permission policy information about static plugins</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The RBAC REST API requires the following components:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Authorization</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The RBAC REST API requires Bearer token authorization for the permitted user role. For development purposes, you can access a web console in a browser. When you refresh a token request in the list of network requests, you find the token in the response JSON.</p>
</div>
<div class="paragraph">
<p><code>Authorization: Bearer $token</code></p>
</div>
<div class="paragraph">
<p>For example, on the Developer Hub <strong>Homepage</strong>, navigate to the <strong>Network</strong> tab and search for the <code>query?term=</code> network call. Alternatively, you can go to the <strong>Catalog</strong> page and select any Catalog API network call to acquire the Bearer token.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">HTTP methods</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The RBAC REST API supports the following HTTP methods for API requests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GET</code>: Retrieves specified information from a specified resource endpoint</p>
</li>
<li>
<p><code>POST</code>: Creates or updates a resource</p>
</li>
<li>
<p><code>PUT</code>: Updates a resource</p>
</li>
<li>
<p><code>DELETE</code>: Deletes a resource</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Base URL</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The base URL for RBAC REST API requests is <code>http://SERVER:PORT/api/permission/policies</code>, such as <code>http://localhost:7007/api/permission/policies</code>.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Endpoints</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RBAC REST API endpoints, such as <code>/api/permission/policies/[kind]/[namespace]/[name]</code> for specified <code>kind</code>, <code>namespace</code>, and <code>name</code>, are the URI that you append to the base URL to access the corresponding resource.</p>
</div>
<div class="paragraph">
<p>Example request URL for <code>/api/permission/policies/[kind]/[namespace]/[name]</code> endpoint is:</p>
</div>
<div class="paragraph">
<p><code>http://localhost:7007/api/permission/policies/user/default/johndoe</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If at least one permission is assigned to <code>user:default/johndoe</code>, then the example request URL mentioned previously returns a result if sent in a <code>GET</code> response with a valid authorization token. However, if permission is only assigned to roles, then the example request URL does not return an output.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Request data</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>HTTP <code>POST</code> requests in the RBAC REST API may require a JSON request body with data to accompany the request.</p>
</div>
<div class="paragraph">
<p>Example <code>POST</code> request URL and JSON request body data for
<code>http://localhost:7007/api/permission/policies</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    "entityReference": "role:default/test",
    "permission": "catalog-entity",
    "policy": "delete",
    "effect": "allow"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">HTTP status codes</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The RBAC REST API supports the following HTTP status codes to return as responses:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>200</code> OK: The request was successful.</p>
</li>
<li>
<p><code>201</code> Created: The request resulted in a new resource being successfully created.</p>
</li>
<li>
<p><code>204</code> No Content: The request was successful, but there is no additional content to send in the response payload.</p>
</li>
<li>
<p><code>400</code> Bad Request: input error with the request</p>
</li>
<li>
<p><code>401</code> Unauthorized: lacks valid authentication for the requested resource</p>
</li>
<li>
<p><code>403</code> Forbidden: refusal to authorize request</p>
</li>
<li>
<p><code>404</code> Not Found: could not find requested resource</p>
</li>
<li>
<p><code>409</code> Conflict: request conflict with the current state and the target resource</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Source</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Each permission policy and role created using the RBAC plugin is associated with a source to maintain data consistency within the plugin. You can manipulate permission policies and roles based on the following designated source information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CSV file</p>
</li>
<li>
<p>Configuration file</p>
</li>
<li>
<p>REST API</p>
</li>
<li>
<p>Legacy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Managing roles and permission policies originating from CSV files and REST API involves straightforward modification based on their initial source information.</p>
</div>
<div class="paragraph">
<p>The Configuration file pertains to the default <code>role:default/rbac_admin</code> role provided by the RBAC plugin. The default role has limited permissions to create, read, update, and delete permission policies or roles, and to read catalog entities.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In case the default permissions are insufficient for your administrative requirements, you can create a custom admin role with required permission policies.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The legacy source applies to policies and roles defined before RBAC backend plugin version <code>2.1.3</code>, and is the least restrictive among the source location options. You must update the permissions and roles in legacy source to use either REST API or the CSV file sources.</p>
</div>
<div class="paragraph">
<p>You can use the <code>GET</code> requests to query roles and policies and determine the source information, if required.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="proc-rbac-send-request-rbac-rest-api_assembly-rhdh-observability">8.4.1. Sending requests with the RBAC REST API using a REST client or curl utility</h4>
<div class="paragraph">
<p>The RBAC REST API enables you to interact with the permission policies and roles in Developer Hub without using the user interface. You can send RBAC REST API requests using any REST client or curl utility.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Red Hat Developer Hub is installed and running.</p>
</li>
<li>
<p>You have access to the Developer Hub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Identify a relevant API endpoint to which you want to send a request, such as <code>POST /api/permission/policies</code>. Adjust any request details according to your use case.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>For REST client</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authorization: Enter the generated token from the web console.</p>
</li>
<li>
<p>HTTP method: Set to <code>POST</code>.</p>
</li>
<li>
<p>URL: Enter the RBAC REST API base URL and endpoint such as
<code>http://localhost:7007/api/permission/policies</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>For curl utility</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-X</code>: Set to <code>POST</code></p>
</li>
<li>
<p><code>-H</code>: Set the following header:</p>
<div class="paragraph">
<p><code>Content-type: application/json</code></p>
</div>
<div class="paragraph">
<p><code>Authorization: Bearer $token</code></p>
</div>
<div class="paragraph">
<p><code>$token</code> is the requested token from the web console in a browser.</p>
</div>
</li>
<li>
<p>URL: Enter the following RBAC REST API base URL endpoint, such as <code>http://localhost:7007/api/permission/policies</code></p>
</li>
<li>
<p><code>-d</code>: Add a request JSON body</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example requests</strong>:</p>
</div>
<div class="paragraph">
<p><code>curl -X POST "http://localhost:7007/api/permission/roles" -d '{"memberReferences": ["group:default/example"], "name": "role:default/test", "metadata": { "description": "This is a test role" } }' -H "Content-Type: application/json" -H "Authorization: Bearer $token" -v</code></p>
</div>
<div class="paragraph">
<p><code>curl -X POST "http://localhost:7007/api/permission/policies" -d '[{"entityReference":"role:default/test", "permission": "catalog-entity", "policy": "read", "effect":"allow"}]' -H "Content-Type: application/json" -H "Authorization: Bearer $token" -v</code></p>
</div>
<div class="paragraph">
<p><code>curl -X POST "http://localhost:7007/api/permission/roles/conditions" -d '{"result": "CONDITIONAL", "roleEntityRef": "role:default/test", "pluginId": "catalog", "resourceType": "catalog-entity", "permissionMapping": ["read"], "conditions": {"rule": "IS_ENTITY_OWNER", "resourceType": "catalog-entity", "params": {"claims": ["group:default/janus-authors"]}}}' -H "Content-Type: application/json" -H "Authorization: Bearer $token" -v</code></p>
</div>
</div>
</div>
</li>
<li>
<p>Execute the request and review the response.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="ref-rbac-rest-api-endpoints_assembly-rhdh-observability">8.4.2. Supported RBAC REST API endpoints</h4>
<div class="paragraph">
<p>The RBAC REST API provides endpoints for managing roles, permissions, and conditional policies in the Developer Hub and for retrieving information about the roles and policies.</p>
</div>
<div class="sect4">
<h5 id="_roles">Roles</h5>
<div class="paragraph">
<p>The RBAC REST API supports the following endpoints for managing roles in the Red Hat Developer Hub.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">[GET] /api/permission/roles</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns all roles in Developer Hub.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "memberReferences": ["user:default/username"],
    "name": "role:default/guests"
  },
  {
    "memberReferences": [
      "group:default/groupname",
      "user:default/username"
    ],
    "name": "role:default/rbac_admin"
  }
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[GET] /api/permission/roles/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns information for a single role in Developer Hub.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "memberReferences": [
      "group:default/groupname",
      "user:default/username"
    ],
    "name": "role:default/rbac_admin"
  }
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[POST] /api/permission/roles/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a role in Developer Hub.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>body</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>memberReferences</code>, <code>group</code>, <code>namespace</code>, and <code>name</code> the new role to be created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request body</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "memberReferences": ["group:default/test"],
  "name": "role:default/test_admin"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>201 Created</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[PUT] /api/permission/roles/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Updates <code>memberReferences</code>, <code>kind</code>, <code>namespace</code>, or <code>name</code> for a role in Developer Hub.</p>
</div>
<div class="paragraph">
<div class="title">Request parameters</div>
<p>The request body contains the <code>oldRole</code> and <code>newRole</code> objects:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>body</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>memberReferences</code>, <code>group</code>, <code>namespace</code>, and <code>name</code> the new role to be created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request body</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "oldRole": {
    "memberReferences": ["group:default/test"],
    "name": "role:default/test_admin"
  },
  "newRole": {
    "memberReferences": ["group:default/test", "user:default/test2"],
    "name": "role:default/test_admin"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>200 OK</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[DELETE] /api/permission/roles/{kind}/{namespace}/{name}?memberReferences=&lt;VALUE&gt;</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Deletes the specified user or group from a role in Developer Hub.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kind of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>memberReferences</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Associated group information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>204</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[DELETE] /api/permission/roles/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Deletes a specified role from Developer Hub.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kind of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>204</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_permission-policies">Permission policies</h5>
<div class="paragraph">
<p>The RBAC REST API supports the following endpoints for managing permission policies in the Red Hat Developer Hub.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">[GET] /api/permission/policies</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns permission policies list for all users.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "entityReference": "role:default/test",
    "permission": "catalog-entity",
    "policy": "read",
    "effect": "allow",
    "metadata": {
      "source": "csv-file"
    }
  },
  {
    "entityReference": "role:default/test",
    "permission": "catalog.entity.create",
    "policy": "use",
    "effect": "allow",
    "metadata": {
      "source": "csv-file"
    }
  },
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[GET] /api/permission/policies/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns permission policies related to the specified entity reference.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kind of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name related to the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "entityReference": "role:default/test",
    "permission": "catalog-entity",
    "policy": "read",
    "effect": "allow",
    "metadata": {
      "source": "csv-file"
    }
  },
  {
    "entityReference": "role:default/test",
    "permission": "catalog.entity.create",
    "policy": "use",
    "effect": "allow",
    "metadata": {
      "source": "csv-file"
    }
  }
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[POST] /api/permission/policies</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a permission policy for a specified entity.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>entityReference</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference values of an entity including <code>kind</code>, <code>namespace</code>, and <code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission from a specific plugin, resource type, or name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy action for the permission, such as <code>create</code>, <code>read</code>, <code>update</code>, <code>delete</code>, or <code>use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>effect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication of allowing or not allowing the policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "entityReference": "role:default/test",
    "permission": "catalog-entity",
    "policy": "read",
    "effect": "allow"
  }
]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>201 Created</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[PUT] /api/permission/policies/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Updates a permission policy for a specified entity.</p>
</div>
<div class="paragraph">
<div class="title">Request parameters</div>
<p>The request body contains the <code>oldPolicy</code> and <code>newPolicy</code> objects:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission from a specific plugin, resource type, or name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy action for the permission, such as <code>create</code>, <code>read</code>, <code>update</code>, <code>delete</code>, or <code>use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>effect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication of allowing or not allowing the policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "oldPolicy": [
    {
      "permission": "catalog-entity",
      "policy": "read",
      "effect": "allow"
    },
    {
      "permission": "catalog.entity.create",
      "policy": "create",
      "effect": "allow"
    }
  ],
  "newPolicy": [
    {
      "permission": "catalog-entity",
      "policy": "read",
      "effect": "deny"
    },
    {
      "permission": "policy-entity",
      "policy": "read",
      "effect": "allow"
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>200</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[DELETE] /api/permission/policies/{kind}/{namespace}/{name}?permission={value1}&amp;policy={value2}&amp;effect={value3}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Deletes a permission policy added to the specified entity.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kind of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name related to the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permission</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission from a specific plugin, resource type, or name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy action for the permission, such as <code>create</code>, <code>read</code>, <code>update</code>, <code>delete</code>, or <code>use</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>effect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication of allowing or not allowing the policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>204 No Content</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[DELETE] /api/permission/policies/{kind}/{namespace}/{name}</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Deletes all permission policies added to the specified entity.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kind of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace of the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name related to the entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>204 No Content</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[GET] /api/permission/plugins/policies</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns permission policies for all static plugins.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "pluginId": "catalog",
    "policies": [
      {
        "isResourced": true,
        "permission": "catalog-entity",
        "policy": "read"
      },
      {
        "isResourced": false,
        "permission": "catalog.entity.create",
        "policy": "create"
      },
      {
        "isResourced": true,
        "permission": "catalog-entity",
        "policy": "delete"
      },
      {
        "isResourced": true,
        "permission": "catalog-entity",
        "policy": "update"
      },
      {
        "isResourced": false,
        "permission": "catalog.location.read",
        "policy": "read"
      },
      {
        "isResourced": false,
        "permission": "catalog.location.create",
        "policy": "create"
      },
      {
        "isResourced": false,
        "permission": "catalog.location.delete",
        "policy": "delete"
      }
    ]
  },
  ...
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_conditional-policies">Conditional policies</h5>
<div class="paragraph">
<p>The RBAC REST API supports the following endpoints for managing conditional policies in the Red Hat Developer Hub.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">[GET] /api/permission/plugins/condition-rules</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns available conditional rule parameter schemas for the available plugins that are enabled in Developer Hub.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
   {
      "pluginId": "catalog",
      "rules": [
         {
            "name": "HAS_ANNOTATION",
            "description": "Allow entities with the specified annotation",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "annotation": {
                     "type": "string",
                     "description": "Name of the annotation to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the annotation to match on"
                  }
               },
               "required": [
                  "annotation"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_LABEL",
            "description": "Allow entities with the specified label",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "label": {
                     "type": "string",
                     "description": "Name of the label to match on"
                  }
               },
               "required": [
                  "label"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_METADATA",
            "description": "Allow entities with the specified metadata subfield",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "key": {
                     "type": "string",
                     "description": "Property within the entities metadata to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the given property to match on"
                  }
               },
               "required": [
                  "key"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "HAS_SPEC",
            "description": "Allow entities with the specified spec subfield",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "key": {
                     "type": "string",
                     "description": "Property within the entities spec to match on"
                  },
                  "value": {
                     "type": "string",
                     "description": "Value of the given property to match on"
                  }
               },
               "required": [
                  "key"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "IS_ENTITY_KIND",
            "description": "Allow entities matching a specified kind",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "kinds": {
                     "type": "array",
                     "items": {
                        "type": "string"
                     },
                     "description": "List of kinds to match at least one of"
                  }
               },
               "required": [
                  "kinds"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         },
         {
            "name": "IS_ENTITY_OWNER",
            "description": "Allow entities owned by a specified claim",
            "resourceType": "catalog-entity",
            "paramsSchema": {
               "type": "object",
               "properties": {
                  "claims": {
                     "type": "array",
                     "items": {
                        "type": "string"
                     },
                     "description": "List of claims to match at least one on within ownedBy"
                  }
               },
               "required": [
                  "claims"
               ],
               "additionalProperties": false,
               "$schema": "http://json-schema.org/draft-07/schema#"
            }
         }
      ]
   }
   ... &lt;another plugin condition parameter schemas&gt;
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[GET] /api/permission/roles/conditions/:id</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns conditions for the specified ID.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "id": 1,
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/test",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["read"],
  "conditions": {
    "anyOf": [
      {
        "rule": "IS_ENTITY_OWNER",
        "resourceType": "catalog-entity",
        "params": {
          "claims": ["group:default/team-a"]
        }
      },
      {
        "rule": "IS_ENTITY_KIND",
        "resourceType": "catalog-entity",
        "params": {
          "kinds": ["Group"]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[GET] /api/permission/roles/conditions</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns list of all conditions for all roles.</p>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[
  {
    "id": 1,
    "result": "CONDITIONAL",
    "roleEntityRef": "role:default/test",
    "pluginId": "catalog",
    "resourceType": "catalog-entity",
    "permissionMapping": ["read"],
    "conditions": {
      "anyOf": [
        {
          "rule": "IS_ENTITY_OWNER",
          "resourceType": "catalog-entity",
          "params": {
            "claims": ["group:default/team-a"]
          }
        },
        {
          "rule": "IS_ENTITY_KIND",
          "resourceType": "catalog-entity",
          "params": {
            "kinds": ["Group"]
          }
        }
      ]
    }
  }
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[POST] /api/permission/roles/conditions</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a conditional policy for the specified role.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always has the value <code>CONDITIONAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roleEntityRef</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String entity reference to the RBAC role, such as <code>role:default/dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pluginId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponding plugin ID, such as <code>catalog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permissionMapping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array permission action, such as <code>['read', 'update', 'delete']</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resourceType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource type provided by the plugin, such as <code>catalog-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conditions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Condition JSON with parameters or array parameters joined by criteria</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata.description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The description of the role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/test",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["read"],
  "conditions": {
    "rule": "IS_ENTITY_OWNER",
    "resourceType": "catalog-entity",
    "params": {
      "claims": ["group:default/team-a"]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "id": 1
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[PUT] /permission/roles/conditions/:id</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Updates a condition policy for a specified ID.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Request parameters</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 15%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always has the value <code>CONDITIONAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>roleEntityRef</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String entity reference to the RBAC role, such as <code>role:default/dev</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pluginId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corresponding plugin ID, such as <code>catalog</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>permissionMapping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array permission action, such as <code>['read', 'update', 'delete']</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resourceType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource type provided by the plugin, such as <code>catalog-entity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conditions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Condition JSON with parameters or array parameters joined by criteria</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>metadata.description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The description of the role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  "result": "CONDITIONAL",
  "roleEntityRef": "role:default/test",
  "pluginId": "catalog",
  "resourceType": "catalog-entity",
  "permissionMapping": ["read"],
  "conditions": {
    "anyOf": [
      {
        "rule": "IS_ENTITY_OWNER",
        "resourceType": "catalog-entity",
        "params": {
          "claims": ["group:default/team-a"]
        }
      },
      {
        "rule": "IS_ENTITY_KIND",
        "resourceType": "catalog-entity",
        "params": {
          "kinds": ["Group"]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>200</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">[DELETE] /api/permission/roles/conditions/:id</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Deletes a conditional policy for the specified ID.</p>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="CodeRay highlight"><code>204</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-admin-templates">Chapter 9. Managing templates</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>A template is a form composed of different UI fields that is defined in a YAML file. Templates include <em>actions</em>, which are steps that are executed in sequential order and can be executed conditionally.</p>
</div>
<div class="paragraph">
<p>You can use templates to easily create Red Hat Developer Hub components, and then publish these components to different locations, such as the Red Hat Developer Hub software catalog, or repositories in GitHub or GitLab.</p>
</div>
<div class="sect2">
<h3 id="proc-creating-templates_assembly-admin-templates">9.1. Creating a template by using the Template Editor</h3>
<div class="paragraph">
<p>You can create a template by using the Template Editor.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Access the Template Editor by using one of the following options:</p>
<div class="imageblock">
<div class="content">
<img src="images/rhdh/template-editor.png" alt="Template Editor">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the URL <code>https://&lt;rhdh_url&gt;/create/edit</code> for your Red Hat Developer Hub instance.</p>
</li>
<li>
<p>Click <strong>Create&#8230;&#8203;</strong> in the navigation menu of the Red Hat Developer Hub console, then click the overflow menu button and select <strong>Template editor</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Edit Template Form</strong>.</p>
</li>
<li>
<p>Optional: Modify the YAML definition for the parameters of your template. For more information about these parameters, see <a href="#ref-creating-templates_assembly-admin-templates">Creating a template as a YAML file</a>.</p>
</li>
<li>
<p>In the <strong>Name *</strong> field, enter a unique name for your template.</p>
</li>
<li>
<p>From the <strong>Owner</strong> drop-down menu, choose an owner for the template.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>In the <strong>Repository Location</strong> view, enter the following information about the hosted repository that you want to publish the template to:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select an available <strong>Host</strong> from the drop-down menu.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Available hosts are defined in the YAML parameters by the <code>allowedHosts</code> field:</p>
</div>
<div class="listingblock">
<div class="title">Example YAML</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
        ui:options:
          allowedHosts:
            - github.com
# ...</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>In the <strong>Owner *</strong> field, enter an organization, user or project that the hosted repository belongs to.</p>
</li>
<li>
<p>In the <strong>Repository *</strong> field, enter the name of the hosted repository.</p>
</li>
<li>
<p>Click <strong>Review</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Review the information for accuracy, then click <strong>Create</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Click the <strong>Catalog</strong> tab in the navigation panel.</p>
</li>
<li>
<p>In the <strong>Kind</strong> drop-down menu, select <strong>Template</strong>.</p>
</li>
<li>
<p>Confirm that your template is shown in the list of existing templates.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ref-creating-templates_assembly-admin-templates">9.2. Creating a template as a YAML file</h3>
<div class="paragraph">
<p>You can create a template by defining a <code>Template</code> object as a YAML file.</p>
</div>
<div class="paragraph">
<p>The <code>Template</code> object describes the template and its metadata. It also contains required input variables and a list of actions that are executed by the scaffolding service.</p>
</div>
<div class="listingblock">
<div class="title"><code>Template</code> object example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: template-name # <b class="conum">(1)</b>
  title: Example template # <b class="conum">(2)</b>
  description: An example template for v1beta3 scaffolder. # <b class="conum">(3)</b>
spec:
  owner: backstage/techdocs-core # <b class="conum">(4)</b>
  type: service # <b class="conum">(5)</b>
  parameters: # <b class="conum">(6)</b>
    - title: Fill in some steps
      required:
        - name
      properties:
        name:
          title: Name
          type: string
          description: Unique name of the component
        owner:
          title: Owner
          type: string
          description: Owner of the component
    - title: Choose a location
      required:
        - repoUrl
      properties:
        repoUrl:
          title: Repository Location
          type: string
  steps: # <b class="conum">(7)</b>
    - id: fetch-base
      name: Fetch Base
      action: fetch:template
      # ...
  output: # <b class="conum">(8)</b>
    links:
      - title: Repository # <b class="conum">(9)</b>
        url: ${{ steps['publish'].output.remoteUrl }}
      - title: Open in catalog # <b class="conum">(10)</b>
        icon: catalog
        entityRef: ${{ steps['register'].output.entityRef }}
# ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Specify a name for the template.</p>
</li>
<li>
<p>Specify a title for the template. This is the title that is visible on the template tile in the <strong>Create&#8230;&#8203;</strong> view.</p>
</li>
<li>
<p>Specify a description for the template. This is the description that is visible on the template tile in the <strong>Create&#8230;&#8203;</strong> view.</p>
</li>
<li>
<p>Specify the ownership of the template. The <code>owner</code> field provides information about who is responsible for maintaining or overseeing the template within the system or organization. In the provided example, the <code>owner</code> field is set to <code>backstage/techdocs-core</code>. This means that this template belongs to the <code>techdocs-core</code> project in the <code>backstage</code> namespace.</p>
</li>
<li>
<p>Specify the component type. Any string value is accepted for this required field, but your organization should establish a proper taxonomy for these. Red Hat Developer Hub instances may read this field and behave differently depending on its value. For example, a <code>website</code> type component may present tooling in the Red Hat Developer Hub interface that is specific to just websites.</p>
<div class="paragraph">
<p>The following values are common for this field:</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>service</code></dt>
<dd>
<p>A backend service, typically exposing an API.</p>
</dd>
<dt class="hdlist1"><code>website</code></dt>
<dd>
<p>A website.</p>
</dd>
<dt class="hdlist1"><code>library</code></dt>
<dd>
<p>A software library, such as an npm module or a Java library.</p>
</dd>
</dl>
</div>
</div>
</div>
</li>
<li>
<p>Use the <code>parameters</code> section to specify parameters for user input that are shown in a form view when a user creates a component by using the template in the Red Hat Developer Hub console. Each <code>parameters</code> subsection, defined by a title and properties, creates a new form page with that definition.</p>
</li>
<li>
<p>Use the <code>steps</code> section to specify steps that are executed in the backend. These steps must be defined by using a unique step ID, a name, and an action. You can view actions that are available on your Red Hat Developer Hub instance by visiting the URL <code>https://&lt;rhdh_url&gt;/create/actions</code>.</p>
</li>
<li>
<p>Use the <code>output</code> section to specify the structure of output data that is created when the template is used. The <code>output</code> section, particularly the <code>links</code> subsection, provides valuable references and URLs that users can utilize to access and interact with components that are created from the template.</p>
</li>
<li>
<p>Provides a reference or URL to the repository associated with the generated component.</p>
</li>
<li>
<p>Provides a reference or URL that allows users to open the generated component in a catalog or directory where various components are listed.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://backstage.io/docs/features/software-templates/writing-templates">Backstage documentation - Writing Templates</a></p>
</li>
<li>
<p><a href="https://backstage.io/docs/features/software-templates/builtin-actions">Backstage documentation - Builtin actions</a></p>
</li>
<li>
<p><a href="https://backstage.io/docs/features/software-templates/writing-custom-actions">Backstage documentation - Writing Custom Actions</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="proc-adding-templates_assembly-admin-templates">9.3. Importing an existing template to Red Hat Developer Hub</h3>
<div class="paragraph">
<p>You can add an existing template to your Red Hat Developer Hub instance by using the Catalog Processor.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a directory or repository that contains at least one template YAML file.</p>
</li>
<li>
<p>If you want to use a template that is stored in a repository such as GitHub or GitLab, you must configure a Red Hat Developer Hub integration for your provider.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>In the <code>app-config.yaml</code> configuration file, modify the <code>catalog.rules</code> section to include a rule for templates, and configure the <code>catalog.locations</code> section to point to the template that you want to add, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"># ...
catalog:
  rules:
    - allow: [Template] # <b class="conum">(1)</b>
  locations:
    - type: url # <b class="conum">(2)</b>
      target: https://&lt;repository_url&gt;/example-template.yaml # <b class="conum">(3)</b>
# ...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>To allow new templates to be added to the catalog, you must add a <code>Template</code> rule.</p>
</li>
<li>
<p>If you are importing templates from a repository, such as GitHub or GitLab, use the <code>url</code> type.</p>
</li>
<li>
<p>Specify the URL for the template.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Verification</div>
<ol class="arabic">
<li>
<p>Click the <strong>Catalog</strong> tab in the navigation panel.</p>
</li>
<li>
<p>In the <strong>Kind</strong> drop-down menu, select <strong>Template</strong>.</p>
</li>
<li>
<p>Confirm that your template is shown in the list of existing templates.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/getting_started_with_red_hat_developer_hub/index">Configuring a GitHub App in Developer Hub</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/getting_started_with_red_hat_developer_hub/index">Enabling the GitLab OAuth authentication provider</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-techdocs-plugin_assembly-admin-templates">Chapter 10. Configuring the TechDocs plugin in Red Hat Developer Hub</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Red Hat Developer Hub TechDocs plugin helps your organization create, find, and use documentation in a central location and in a standardized way. For example:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Docs-like-code approach</dt>
<dd>
<p>Write your technical documentation in Markdown files that are stored inside your project repository along with your code.</p>
</dd>
<dt class="hdlist1">Documentation site generation</dt>
<dd>
<p>Use MkDocs to create a full-featured, Markdown-based, static HTML site for your documentation that is rendered centrally in Developer Hub.</p>
</dd>
<dt class="hdlist1">Documentation site metadata and integrations</dt>
<dd>
<p>See additional metadata about the documentation site alongside the static documentation, such as the date of the last update, the site owner, top contributors, open GitHub issues, Slack support channels, and Stack Overflow Enterprise tags.</p>
</dd>
<dt class="hdlist1">Built-in navigation and search</dt>
<dd>
<p>Find the information that you want from a document more quickly and easily.</p>
</dd>
<dt class="hdlist1">Add-ons</dt>
<dd>
<p>Customize your TechDocs experience with Add-ons to address higher-order documentation needs.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The TechDocs plugin is preinstalled and enabled on a Developer Hub instance by default. You can disable or enable the TechDocs plugin, and change other parameters, by configuring the Red Hat Developer Hub Helm chart or the Red Hat Developer Hub Operator config map.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>Red Hat Developer Hub includes a built-in TechDocs builder that generates static HTML documentation from your codebase. However, the default basic setup of the local builder is not intended for production.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use a CI/CD pipeline with the repository that has a dedicated job to generate docs for TechDocs. The generated static files are stored in OpenShift Data Foundation or in a cloud storage solution of your choice and published to a static HTML documentation site.</p>
</div>
<div class="paragraph">
<p>After you configure OpenShift Data Foundation to store the files that TechDocs generates, you can configure the TechDocs plugin to use the OpenShift Data Foundation for cloud storage.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.3/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="con-techdocs-configure-storage_assembly-admin-templates">10.1. Configuring storage for TechDocs files</h3>
<div class="paragraph">
<p>The TechDocs publisher stores generated files in local storage or in cloud storage, such as OpenShift Data Foundation, Google GCS, AWS S3, or Azure Blob Storage.</p>
</div>
<div class="sect3">
<h4 id="proc-techdocs-using-odf-storage_assembly-admin-templates">10.1.1. Using OpenShift Data Foundation for file storage</h4>
<div class="paragraph">
<p>You can configure OpenShift Data Foundation to store the files that TechDocs generates instead of relying on other cloud storage solutions.</p>
</div>
<div class="paragraph">
<p>OpenShift Data Foundation provides an <code>ObjectBucketClaim</code> custom resource (CR) that you can use to request an S3 compatible bucket backend. You must install the OpenShift Data Foundation Operator to use this feature.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An OpenShift Container Platform administrator has installed the OpenShift Data Foundation Operator in Red Hat OpenShift Container Platform. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.15/html/deploying_openshift_data_foundation_using_amazon_web_services/deploy-using-dynamic-storage-devices-aws#installing-openshift-data-foundation-operator-using-the-operator-hub_cloud-storage">OpenShift Container Platform - Installing Red Hat OpenShift Data Foundation Operator</a>.</p>
</li>
<li>
<p>An OpenShift Container Platform administrator has created an OpenShift Data Foundation cluster and configured the <code>StorageSystem</code> schema. For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/latest/html/deploying_openshift_data_foundation_using_amazon_web_services/deploy-using-dynamic-storage-devices-aws#creating-an-openshift-data-foundation-service_cloud-storage">OpenShift Container Platform - Creating an OpenShift Data Foundation cluster</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Create an <code>ObjectBucketClaim</code> CR where the generated TechDocs files are stored. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">apiVersion: objectbucket.io/v1alpha1
kind: ObjectBucketClaim
metadata:
  name: &lt;rhdh_bucket_claim_name&gt;
spec:
  generateBucketName: &lt;rhdh_bucket_claim_name&gt;
  storageClassName: openshift-storage.noobaa.io</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Creating the Developer Hub <code>ObjectBucketClaim</code> CR automatically creates both the Developer Hub <code>ObjectBucketClaim</code> config map and secret. The config map and secret have the same name as the <code>ObjetBucketClaim</code> CR.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you create the <code>ObjectBucketClaim</code> CR, you can use the information stored in the config map and secret to make the information accessible to the Developer Hub container as environment variables. Depending on the method that you used to install Developer Hub, you add the access information to either the Red Hat Developer Hub Helm chart or Operator configuration.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more information about the Object Bucket Claim, see <a href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.12/html/managing_hybrid_and_multicloud_resources/object-bucket-claim#doc-wrapper">OpenShift Container Platform - Object Bucket Claim</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-techdocs-configure-odf-helm_assembly-admin-templates">10.1.2. Making object storage accessible to containers by using the Helm chart</h4>
<div class="paragraph">
<p>Creating a <code>ObjectBucketClaim</code> custom resource (CR) automatically generates both the Developer Hub <code>ObjectBucketClaim</code> config map and secret. The config map and secret contain <code>ObjectBucket</code> access information. Adding the access information to the Helm chart configuration makes it accessible to the Developer Hub container by adding the following environment variables to the container:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BUCKET_NAME</code></p>
</li>
<li>
<p><code>BUCKET_HOST</code></p>
</li>
<li>
<p><code>BUCKET_PORT</code></p>
</li>
<li>
<p><code>BUCKET_REGION</code></p>
</li>
<li>
<p><code>BUCKET_SUBREGION</code></p>
</li>
<li>
<p><code>AWS_ACCESS_KEY_ID</code></p>
</li>
<li>
<p><code>AWS_SECRET_ACCESS_KEY</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These variables are then used in the TechDocs plugin configuration.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm chart.</p>
</li>
<li>
<p>You have created an <code>ObjectBucketClaim</code> CR for storing files generated by TechDocs. For more information see <a href="#proc-techdocs-using-odf-storage_assembly-admin-templates">Using OpenShift Data Foundation for file storage</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>In the <code>upstream.backstage</code> key in the Helm chart values, enter the name of the Developer Hub <code>ObjectBucketClaim</code> secret as the value for the <code>extraEnvVarsSecrets</code> field and the <code>extraEnvVarsCM</code> field. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">upstream:
  backstage:
    extraEnvVarsSecrets:
      - &lt;rhdh_bucket_claim_name&gt;
    extraEnvVarsCM:
      - &lt;rhdh_bucket_claim_name&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="ref-techdocs-example-config-plugin-helm_assembly-admin-templates">Example TechDocs Plugin configuration for the Helm chart</h5>
<div class="paragraph">
<p>The following example shows a Developer Hub Helm chart configuration for the TechDocs plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">global:
  dynamic:
    includes:
      - 'dynamic-plugins.default.yaml'
  plugins:
    - disabled: false
      package: ./dynamic-plugins/dist/backstage-plugin-techdocs-backend-dynamic
      pluginConfig:
        techdocs:
          builder: external
          generator:
            runIn: local
          publisher:
            awsS3:
              bucketName: '${BUCKET_NAME}'
              credentials:
                accessKeyId: '${AWS_ACCESS_KEY_ID}'
                secretAccessKey: '${AWS_SECRET_ACCESS_KEY}'
              endpoint: 'https://${BUCKET_HOST}'
              regions: '${BUCKET_REGION}'
              s3ForcePathStyle: true
            type: awsS3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-techdocs-configure-odf-operator_assembly-admin-templates">10.1.3. Making object storage accessible to containers by using the Operator</h4>
<div class="paragraph">
<p>Creating a <code>ObjectBucketClaim</code> Custom Resource (CR) automatically generates both the Developer Hub <code>ObjectBucketClaim</code> config map and secret. The config map and secret contain <code>ObjectBucket</code> access information. Adding the access information to the Operator configuration makes it accessible to the Developer Hub container by adding the following environment variables to the container:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BUCKET_NAME</code></p>
</li>
<li>
<p><code>BUCKET_HOST</code></p>
</li>
<li>
<p><code>BUCKET_PORT</code></p>
</li>
<li>
<p><code>BUCKET_REGION</code></p>
</li>
<li>
<p><code>BUCKET_SUBREGION</code></p>
</li>
<li>
<p><code>AWS_ACCESS_KEY_ID</code></p>
</li>
<li>
<p><code>AWS_SECRET_ACCESS_KEY</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These variables are then used in the TechDocs plugin configuration.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed Red Hat Developer Hub on OpenShift Container Platform using the Operator.</p>
</li>
<li>
<p>You have created an <code>ObjectBucketClaim</code> CR for storing files generated by TechDocs.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>In the Developer Hub <code>ObjectBucketClaim</code> CR, enter the name of the Developer Hub <code>ObjectBucketClaim</code> config map as the value for the <code>spec.application.extraEnvs.configMaps</code> field and enter the Developer Hub <code>ObjectBucketClaim</code> secret name as the value for the <code>spec.application.extraEnvs.secrets</code> field. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml">spec:
  application:
    extraEnvs:
      configMaps:
        - name: &lt;rhdh_bucket_claim_name&gt;
      secrets:
        - name: &lt;rhdh_bucket_claim_name&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="ref-techdocs-example-config-plugin-operator_assembly-admin-templates">Example TechDocs Plugin configuration for the Operator</h5>
<div class="paragraph">
<p>The following example shows a Red Hat Developer Hub Operator config map configuration for the TechDocs plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - disabled: false
        package: ./dynamic-plugins/dist/backstage-plugin-techdocs-backend-dynamic
        pluginConfig:
          techdocs:
            builder: external
            generator:
              runIn: local
            publisher:
              awsS3:
                bucketName: '${BUCKET_NAME}'
                credentials:
                  accessKeyId: '${AWS_ACCESS_KEY_ID}'
                  secretAccessKey: '${AWS_SECRET_ACCESS_KEY}'
                endpoint: 'https://${BUCKET_HOST}'
                regions: '${BUCKET_REGION}'
                s3ForcePathStyle: true
              type: awsS3</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-techdocs-config-cicd_assembly-admin-templates">10.2. Configuring CI/CD to generate and publish TecDocs sites</h3>
<div class="paragraph">
<p>TechDocs reads the static generated documentation files from a cloud storage bucket, such as OpenShift Data Foundation. The documentation site is generated on the CI/CD workflow associated with the repository containing the documentation files. You can generate docs on CI and publish to a cloud storage using the <code>techdocs-cli</code> CLI tool.</p>
</div>
<div class="paragraph">
<p>You can use the following example to create a script for TechDocs publication:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="shell"># Prepare
REPOSITORY_URL='https://github.com/org/repo'
git clone $REPOSITORY_URL
cd repo

# Install @techdocs/cli, mkdocs and mkdocs plugins
npm install -g @techdocs/cli
pip install "mkdocs-techdocs-core==1.*"

# Generate
techdocs-cli generate --no-docker

# Publish
techdocs-cli publish --publisher-type awsS3 --storage-name &lt;bucket/container&gt; --entity &lt;Namespace/Kind/Name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The TechDocs workflow starts the CI when a user makes changes in the repository containing the documentation files. You can configure the workflow to start only when files inside the <code>docs/</code> directory or <code>mkdocs.yml</code> are changed.</p>
</div>
<div class="sect3">
<h4 id="proc-techdocs-config-cicd-prep-repo_assembly-admin-templates">10.2.1. Preparing your repository for CI</h4>
<div class="paragraph">
<p>The first step on the CI is to clone your documentation source repository in a working directory.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To clone your documentation source repository in a working directory, enter the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">git clone &lt;https://path/to/docs-repository/&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-techdocs-generate-site_assembly-admin-templates">10.2.2. Generating the TechDocs site</h4>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To configure CI/CD to generate your techdocs, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the <code>npx</code> package to run <code>techdocs-cli</code> using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>npm install -g npx</code></pre>
</div>
</div>
</li>
<li>
<p>Install the <code>techdocs-cli</code> tool using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>npm install -g @techdocs/cli</code></pre>
</div>
</div>
</li>
<li>
<p>Install the <code>mkdocs</code> plugins using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>pip install "mkdocs-techdocs-core==1.*"</code></pre>
</div>
</div>
</li>
<li>
<p>Generate your techdocs site using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">npx @techdocs/cli generate --no-docker --source-dir &lt;path_to_repo&gt; --output-dir ./site</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>&lt;path_to_repo&gt;</code> is the location in the file path that you used to clone your repository.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-techdocs-publish-site_assembly-admin-templates">10.2.3. Publishing the TechDocs site</h4>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To publish your techdocs site, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the necessary authentication environment variables for your cloud storage provider.</p>
</li>
<li>
<p>Publish your techdocs using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal">npx @techdocs/cli publish --publisher-type &lt;awsS3|googleGcs&gt; --storage-name &lt;bucket/container&gt; --entity &lt;namespace/kind/name&gt; --directory ./site</code></pre>
</div>
</div>
</li>
<li>
<p>Add a <code>.github/workflows/techdocs.yml</code> file in your Software Template(s). For example:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>name: Publish TechDocs Site

on:
 push:
   branches: [main]
   # You can even set it to run only when TechDocs related files are updated.
   # paths:
   #   - "docs/**"
   #   - "mkdocs.yml"

jobs:
 publish-techdocs-site:
   runs-on: ubuntu-latest

   # The following secrets are required in your CI environment for publishing files to AWS S3.
   # e.g. You can use GitHub Organization secrets to set them for all existing and new repositories.
   env:
     TECHDOCS_S3_BUCKET_NAME: ${{ secrets.TECHDOCS_S3_BUCKET_NAME }}
     AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
     AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
     AWS_REGION: ${{ secrets.AWS_REGION }}
     ENTITY_NAMESPACE: 'default'
     ENTITY_KIND: 'Component'
     ENTITY_NAME: 'my-doc-entity'
     # In a Software template, Scaffolder will replace {{cookiecutter.component_id | jsonify}}
     # with the correct entity name. This is same as metadata.name in the entity's catalog-info.yaml
     # ENTITY_NAME: '{{ cookiecutter.component_id | jsonify }}'

   steps:
     - name: Checkout code
       uses: actions/checkout@v3

     - uses: actions/setup-node@v3
     - uses: actions/setup-python@v4
       with:
         python-version: '3.9'

     - name: Install techdocs-cli
       run: sudo npm install -g @techdocs/cli

     - name: Install mkdocs and mkdocs plugins
       run: python -m pip install mkdocs-techdocs-core==1.*

     - name: Generate docs site
       run: techdocs-cli generate --no-docker --verbose

     - name: Publish docs site
       run: techdocs-cli publish --publisher-type awsS3 --storage-name $TECHDOCS_S3_BUCKET_NAME --entity $ENTITY_NAMESPACE/$ENTITY_KIND/$ENTITY_NAME</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-08-06 17:59:41 UTC
</div>
</div>
</body>
</html>